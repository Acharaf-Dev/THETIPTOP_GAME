{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import axios from\"axios\";import DashboardLayout from\"../../components/DashboardLayout\";import PrizeDistributionChart from\"../../components/PrizeDistributionChart\";import TicketUsageChart from\"../../components/TicketUsageChart\";import UserActivityChart from\"../../components/UserActivityChart\";// import { useNavigate } from \"react-router-dom\";\nimport{FiUsers,FiUserCheck,FiPackage,FiDollarSign,FiPieChart,FiTrendingUp,FiCalendar,FiClock,FiCheckCircle,FiXCircle,FiGift,FiLock,FiUnlock}from\"react-icons/fi\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const API_URL=process.env.REACT_APP_API_URL||\"http://localhost:4000/api\";// Correction ici\nconst AdminDashboard=()=>{// State variables for data\nconst[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[users,setUsers]=useState([]);const[clients,setClients]=useState([]);const[employees,setEmployees]=useState([]);const[gameStats,setGameStats]=useState(null);const[activeTab,setActiveTab]=useState(\"overview\");const[selectedFilter,setSelectedFilter]=useState(\"all\");// const navigate = useNavigate();\n// State for user details modal\nconst[showUserModal,setShowUserModal]=useState(false);const[selectedUser,setSelectedUser]=useState(null);// Fetch data from backend on component mount\nuseEffect(()=>{const fetchData=async()=>{setLoading(true);setError(null);const token=localStorage.getItem(\"token\");if(!token){setError(\"Authentication token not found. Please log in again.\");setLoading(false);return;}try{// Vérification des permissions admin avant récupération des données\nconst userProfileResponse=await axios.get(`${API_URL}/user/userprofile`,{headers:{Authorization:`Bearer ${token}`}});const userProfile=userProfileResponse.data.user;if(userProfile.userType!==\"admin\"){setError(\"Access forbidden: insufficient permissions. Admin access required.\");setLoading(false);return;}const headers={Authorization:`Bearer ${token}`};// Chargement des données uniquement si l'utilisateur est un admin\nconst[usersRes,clientsRes,employeesRes,gameStatsRes]=await Promise.all([axios.get(`${API_URL}/user/allusers`,{headers}),axios.get(`${API_URL}/user/allclients`,{headers}),axios.get(`${API_URL}/user/allemployers`,{headers}),axios.get(`${API_URL}/user/usersgains`,{headers})]);setUsers(usersRes.data.users||[]);setClients(clientsRes.data.clients||[]);setEmployees(employeesRes.data.employers||[]);setGameStats(gameStatsRes.data||{});}catch(err){var _err$response;console.error(\"Error fetching dashboard data:\",err);if(((_err$response=err.response)===null||_err$response===void 0?void 0:_err$response.status)===403){setError(\"Access forbidden: insufficient permissions. Admin access required.\");}else{var _err$response2,_err$response2$data;setError(((_err$response2=err.response)===null||_err$response2===void 0?void 0:(_err$response2$data=_err$response2.data)===null||_err$response2$data===void 0?void 0:_err$response2$data.message)||\"Failed to fetch dashboard data\");}}finally{setLoading(false);}};fetchData();},[]);// Formatage des dates pour l'affichage\nconst formatDate=dateString=>{const options={year:\"numeric\",month:\"short\",day:\"numeric\"};return new Date(dateString).toLocaleDateString(undefined,options);};// Déconnexion utilisateur\nconst handleLogoutUser=async userId=>{try{const token=localStorage.getItem(\"token\");await axios.post(`${API_URL}/user/logoutuser/${userId}`,{},{headers:{Authorization:`Bearer ${token}`}});// alert(\"L'utilisateur a été déconnecté avec succès\");\n// Rafraîchir la liste des utilisateurs\nconst updatedUsers=users.map(user=>{if(user._id===userId){return{...user,isActive:false};}return user;});setUsers(updatedUsers);}catch(err){var _err$response3,_err$response3$data;alert(\"Erreur lors de la déconnexion de l'utilisateur: \"+(((_err$response3=err.response)===null||_err$response3===void 0?void 0:(_err$response3$data=_err$response3.data)===null||_err$response3$data===void 0?void 0:_err$response3$data.message)||err.message));}};// Gestion de l'accès au jeu pour les utilisateurs\nconst toggleGameAccess=async(userId,currentAccess)=>{try{const token=localStorage.getItem(\"token\");const newAccess=!currentAccess;await axios.put(`${API_URL}/user/updateuser/${userId}`,{gameAccess:newAccess},{headers:{Authorization:`Bearer ${token}`}});// Mise à jour de l'état local des utilisateurs\nconst updatedUsers=users.map(user=>{if(user._id===userId){return{...user,gameAccess:newAccess};}return user;});setUsers(updatedUsers);// Si la fenêtre modale est ouverte, mise à jour de l'utilisateur sélectionné\nif(selectedUser&&selectedUser._id===userId){setSelectedUser({...selectedUser,gameAccess:newAccess});}alert(`L'accès au jeu a été ${newAccess?\"activé\":\"désactivé\"} pour cet utilisateur`);}catch(err){var _err$response4,_err$response4$data;alert(\"Erreur lors de la modification d'accès au jeu: \"+(((_err$response4=err.response)===null||_err$response4===void 0?void 0:(_err$response4$data=_err$response4.data)===null||_err$response4$data===void 0?void 0:_err$response4$data.message)||err.message));}};// Show user details modal\nconst showUserDetails=user=>{setSelectedUser(user);setShowUserModal(true);};// User details modal\nconst UserDetailsModal=()=>{var _selectedUser$userNam,_selectedUser$address;if(!selectedUser)return null;return/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-start mb-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-gray-900\",children:\"D\\xE9tails de l'utilisateur\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowUserModal(false),className:\"text-gray-500 hover:text-gray-700\",children:/*#__PURE__*/_jsx(\"svg\",{className:\"w-6 h-6\",fill:\"none\",strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:\"2\",viewBox:\"0 0 24 24\",stroke:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M6 18L18 6M6 6l12 12\"})})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center mb-8\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"h-20 w-20 rounded-full bg-gray-200 flex items-center justify-center text-gray-700 font-semibold text-3xl\",children:((_selectedUser$userNam=selectedUser.userName)===null||_selectedUser$userNam===void 0?void 0:_selectedUser$userNam.charAt(0).toUpperCase())||\"?\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"ml-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-semibold\",children:selectedUser.userName}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:selectedUser.email}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-1\",children:[/*#__PURE__*/_jsx(\"span\",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full \n                  ${selectedUser.userType===\"admin\"?\"bg-purple-100 text-purple-800\":selectedUser.userType===\"client\"?\"bg-green-100 text-green-800\":\"bg-blue-100 text-blue-800\"}`,children:selectedUser.userType===\"admin\"?\"Administrateur\":selectedUser.userType===\"client\"?\"Client\":\"Employé\"}),/*#__PURE__*/_jsx(\"span\",{className:`ml-2 px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full \n                  ${selectedUser.gameAccess===false?\"bg-red-100 text-red-800\":\"bg-green-100 text-green-800\"}`,children:selectedUser.gameAccess===false?\"Accès au jeu bloqué\":\"Accès au jeu autorisé\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-sm font-medium text-gray-500 mb-2\",children:\"Coordonn\\xE9es\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 p-4 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm mb-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:\"T\\xE9l\\xE9phone:\"}),\" \",selectedUser.phone]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm mb-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:\"Adresse:\"}),\" \",((_selectedUser$address=selectedUser.address)===null||_selectedUser$address===void 0?void 0:_selectedUser$address.join(\", \"))||\"Non spécifiée\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-sm font-medium text-gray-500 mb-2\",children:\"Informations du compte\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 p-4 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm mb-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:\"Inscrit le:\"}),\" \",formatDate(selectedUser.createdAt)]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm mb-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:\"Mis \\xE0 jour le:\"}),\" \",formatDate(selectedUser.updatedAt)]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between border-t pt-6\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>toggleGameAccess(selectedUser._id,selectedUser.gameAccess),className:`flex items-center px-4 py-2 rounded-md text-sm font-medium ${selectedUser.gameAccess?\"bg-red-100 text-red-800 hover:bg-red-200\":\"bg-green-100 text-green-800 hover:bg-green-200\"}`,children:selectedUser.gameAccess?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(FiLock,{className:\"mr-2\"}),\"Bloquer l'acc\\xE8s au jeu\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(FiUnlock,{className:\"mr-2\"}),\"Autoriser l'acc\\xE8s au jeu\"]})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleLogoutUser(selectedUser._id),className:\"bg-red-100 text-red-800 hover:bg-red-200 px-4 py-2 rounded-md text-sm font-medium ml-2\",children:\"D\\xE9connecter\"})})]})]})});};// Render Users Tab\nconst renderUsersTab=()=>{let filteredUsers=users;if(selectedFilter===\"client\"){filteredUsers=users.filter(user=>user.userType===\"client\");}else if(selectedFilter===\"employee\"){filteredUsers=users.filter(user=>user.userType===\"employer\");}else if(selectedFilter===\"admin\"){filteredUsers=users.filter(user=>user.userType===\"admin\");}return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl shadow-md border border-gray-100 overflow-hidden\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"px-6 py-4 border-b border-gray-200 flex justify-between items-center\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-800\",children:\"Gestion des Utilisateurs\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex\",children:/*#__PURE__*/_jsxs(\"select\",{className:\"px-4 py-2 border border-gray-300 rounded-md bg-white focus:outline-none focus:ring-2 focus:ring-blue-500\",value:selectedFilter,onChange:e=>setSelectedFilter(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"all\",children:\"Tous les Utilisateurs\"}),/*#__PURE__*/_jsx(\"option\",{value:\"client\",children:\"Clients Seulement\"}),/*#__PURE__*/_jsx(\"option\",{value:\"employee\",children:\"Employ\\xE9s Seulement\"}),/*#__PURE__*/_jsx(\"option\",{value:\"admin\",children:\"Admins Seulement\"})]})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"px-6 overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"min-w-full divide-y divide-gray-200\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Nom\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Email\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Type d'Utilisateur\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Acc\\xE8s au jeu\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Inscrit le\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 bg-gray-50 text-right text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{className:\"bg-white divide-y divide-gray-200\",children:filteredUsers.slice(0,10).map(user=>{var _user$userName;return/*#__PURE__*/_jsxs(\"tr\",{className:\"hover:bg-gray-50\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center text-gray-700 font-semibold\",children:((_user$userName=user.userName)===null||_user$userName===void 0?void 0:_user$userName.charAt(0).toUpperCase())||\"?\"}),/*#__PURE__*/_jsx(\"div\",{className:\"ml-4\",children:/*#__PURE__*/_jsx(\"div\",{className:\"text-sm font-medium text-gray-900\",children:user.userName})})]})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\",children:user.email}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap\",children:/*#__PURE__*/_jsx(\"span\",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full \n                      ${user.userType===\"admin\"?\"bg-purple-100 text-purple-800\":user.userType===\"client\"?\"bg-green-100 text-green-800\":\"bg-blue-100 text-blue-800\"}`,children:user.userType===\"admin\"?\"Administrateur\":user.userType===\"client\"?\"Client\":\"Employé\"})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap\",children:/*#__PURE__*/_jsx(\"span\",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full \n                      ${user.gameAccess===false?\"bg-red-100 text-red-800\":\"bg-green-100 text-green-800\"}`,children:user.gameAccess===false?\"Bloqué\":\"Autorisé\"})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(FiClock,{className:\"mr-2 text-gray-400\"}),formatDate(user.createdAt)]})}),/*#__PURE__*/_jsxs(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-right text-sm font-medium\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"text-blue-600 hover:text-blue-900 mr-3\",onClick:()=>showUserDetails(user),children:\"Voir\"}),/*#__PURE__*/_jsx(\"button\",{className:\"text-red-600 hover:text-red-900\",onClick:()=>handleLogoutUser(user._id),children:\"D\\xE9connecter\"})]})]},user._id);})})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"px-6 py-4 border-t border-gray-200 flex justify-between items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-700\",children:[\"Affichage de \",/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:\"1\"}),\" \\xE0\",\" \",/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:Math.min(filteredUsers.length,10)}),\" \",\"sur \",/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:filteredUsers.length}),\" \",\"r\\xE9sultats\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-2\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"px-3 py-1 border border-gray-300 bg-white text-gray-500 text-sm rounded-md disabled:opacity-50\",children:\"Pr\\xE9c\\xE9dent\"}),/*#__PURE__*/_jsx(\"button\",{className:\"px-3 py-1 border border-gray-300 bg-white text-gray-500 text-sm rounded-md hover:bg-gray-50 disabled:opacity-50\",children:\"Suivant\"})]})]})]});};// Render Dashboard Overview\nconst renderOverview=()=>{// Format data for charts\nconst userActivityData=[{name:\"Jan\",value:28},{name:\"Fév\",value:45},{name:\"Mar\",value:32},{name:\"Avr\",value:56},{name:\"Mai\",value:78},{name:\"Juin\",value:63}];// Only use real ticket data if available\nconst ticketUsageData=gameStats&&gameStats.ticketStats&&gameStats.ticketStats.used>0?[{name:\"Utilisés\",value:gameStats.ticketStats.used||0},{name:\"Non utilisés\",value:gameStats.ticketStats.remaining||0}]:null;// Only use real prize data if available\nconst prizeDistributionData=gameStats&&gameStats.prizeDistribution&&gameStats.prizeDistribution.length>0?gameStats.prizeDistribution:null;// Calculate some statistics\nlet totalUsers=users.length||0;let clientCount=clients.length||0;let employeeCount=employees.length||0;let adminCount=users.filter(u=>u.userType===\"admin\").length||0;// Calculate recent gains if data available\nlet recentGains=[];if(gameStats&&gameStats.gains){recentGains=gameStats.gains.slice(0,5);}// Calculate ticket stats\nconst ticketStats=gameStats&&gameStats.ticketStats&&(gameStats.ticketStats.used>0||gameStats.ticketStats.remaining>0)?gameStats.ticketStats:null;const totalTickets=ticketStats?ticketStats.used+ticketStats.remaining:0;const usageRate=totalTickets>0?Math.round(ticketStats.used/totalTickets*100):0;// Check if we have valid ticket data to display\nconst hasValidTicketStats=ticketStats&&totalTickets>0;const hasValidPrizeData=prizeDistributionData&&prizeDistributionData.length>0;return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-xl shadow-md p-6 transition-all duration-200 hover:shadow-lg border border-gray-100\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-start\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500 font-medium\",children:\"Total Utilisateurs\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold text-gray-800 mt-1\",children:totalUsers})]}),/*#__PURE__*/_jsx(\"div\",{className:\"p-3 rounded-full bg-blue-100 text-blue-600\",children:/*#__PURE__*/_jsx(FiUsers,{className:\"h-6 w-6\"})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-xl shadow-md p-6 transition-all duration-200 hover:shadow-lg border border-gray-100\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-start\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500 font-medium\",children:\"Clients Actifs\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold text-gray-800 mt-1\",children:clientCount})]}),/*#__PURE__*/_jsx(\"div\",{className:\"p-3 rounded-full bg-green-100 text-green-600\",children:/*#__PURE__*/_jsx(FiUserCheck,{className:\"h-6 w-6\"})})]})}),gameStats&&gameStats.totalPrizeValue?/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-xl shadow-md p-6 transition-all duration-200 hover:shadow-lg border border-gray-100\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-start\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500 font-medium\",children:\"Valeur Totale des Prix\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-2xl font-bold text-gray-800 mt-1\",children:[gameStats.totalPrizeValue,\" \\u20AC\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"p-3 rounded-full bg-purple-100 text-purple-600\",children:/*#__PURE__*/_jsx(FiPackage,{className:\"h-6 w-6\"})})]})}):/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-xl shadow-md p-6 transition-all duration-200 hover:shadow-lg border border-gray-100\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-start\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500 font-medium\",children:\"Employ\\xE9s\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold text-gray-800 mt-1\",children:employeeCount})]}),/*#__PURE__*/_jsx(\"div\",{className:\"p-3 rounded-full bg-blue-100 text-blue-600\",children:/*#__PURE__*/_jsx(FiUserCheck,{className:\"h-6 w-6\"})})]})}),hasValidTicketStats?/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-xl shadow-md p-6 transition-all duration-200 hover:shadow-lg border border-gray-100\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-start\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500 font-medium\",children:\"Taux d'Utilisation des Tickets\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-2xl font-bold text-gray-800 mt-1\",children:[usageRate,\"%\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"p-3 rounded-full bg-amber-100 text-amber-600\",children:/*#__PURE__*/_jsx(FiPieChart,{className:\"h-6 w-6\"})})]})}):/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-xl shadow-md p-6 transition-all duration-200 hover:shadow-lg border border-gray-100\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-start\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500 font-medium\",children:\"Administrateurs\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold text-gray-800 mt-1\",children:adminCount})]}),/*#__PURE__*/_jsx(\"div\",{className:\"p-3 rounded-full bg-purple-100 text-purple-600\",children:/*#__PURE__*/_jsx(FiUserCheck,{className:\"h-6 w-6\"})})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-3 gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:`bg-white rounded-xl shadow-md border border-gray-100 col-span-1 ${hasValidTicketStats&&ticketUsageData?\"lg:col-span-2\":\"lg:col-span-3\"}`,children:[/*#__PURE__*/_jsx(\"div\",{className:\"px-6 py-4 border-b border-gray-200\",children:/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-800\",children:\"Tendance d'Activit\\xE9 des Utilisateurs\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"p-4 h-72\",children:/*#__PURE__*/_jsx(UserActivityChart,{data:userActivityData})})]}),hasValidTicketStats&&ticketUsageData&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl shadow-md border border-gray-100\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"px-6 py-4 border-b border-gray-200\",children:/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-800\",children:\"Utilisation des Tickets\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"p-4 h-72\",children:/*#__PURE__*/_jsx(TicketUsageChart,{data:ticketUsageData})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-2 gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:`bg-white rounded-xl shadow-md border border-gray-100 ${!hasValidPrizeData?\"lg:col-span-2\":\"\"}`,children:[/*#__PURE__*/_jsx(\"div\",{className:\"px-6 py-4 border-b border-gray-200\",children:/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-800\",children:\"Composition des Utilisateurs\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"p-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"w-full\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between mb-1\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-medium text-gray-700\",children:\"Admin\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm font-medium text-gray-700\",children:[users.filter(u=>u.userType===\"admin\").length,\" (\",Math.round(users.filter(u=>u.userType===\"admin\").length/users.length*100),\"%)\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full bg-gray-100 rounded-full h-2.5\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-purple-600 h-2.5 rounded-full\",style:{width:`${users.length?users.filter(u=>u.userType===\"admin\").length/users.length*100:0}%`}})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"w-full\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between mb-1\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-medium text-gray-700\",children:\"Clients\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm font-medium text-gray-700\",children:[users.filter(u=>u.userType===\"client\").length,\" (\",Math.round(users.filter(u=>u.userType===\"client\").length/users.length*100),\"%)\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full bg-gray-100 rounded-full h-2.5\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-green-600 h-2.5 rounded-full\",style:{width:`${users.length?users.filter(u=>u.userType===\"client\").length/users.length*100:0}%`}})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"w-full\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between mb-1\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-medium text-gray-700\",children:\"Employ\\xE9s\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm font-medium text-gray-700\",children:[users.filter(u=>u.userType===\"employer\").length,\" \",\"(\",Math.round(users.filter(u=>u.userType===\"employer\").length/users.length*100),\"%)\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full bg-gray-100 rounded-full h-2.5\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-blue-600 h-2.5 rounded-full\",style:{width:`${users.length?users.filter(u=>u.userType===\"employer\").length/users.length*100:0}%`}})})]})})]})})]}),hasValidPrizeData&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl shadow-md border border-gray-100\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"px-6 py-4 border-b border-gray-200\",children:/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-800\",children:\"Distribution des Prix\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"p-4 h-72\",children:/*#__PURE__*/_jsx(PrizeDistributionChart,{data:prizeDistributionData})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-2 gap-6\",children:[hasValidTicketStats&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl shadow-md border border-gray-100\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"px-6 py-4 border-b border-gray-200\",children:/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-800\",children:\"Statistiques des Tickets\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"p-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-blue-50 rounded-lg p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-blue-800 font-medium\",children:\"Tickets G\\xE9n\\xE9r\\xE9s\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xl font-bold text-blue-900 mt-1\",children:totalTickets})]}),/*#__PURE__*/_jsx(\"div\",{className:\"p-2 rounded-full bg-blue-100\",children:/*#__PURE__*/_jsx(FiPackage,{className:\"h-5 w-5 text-blue-700\"})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-green-50 rounded-lg p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-green-800 font-medium\",children:\"Tickets Utilis\\xE9s\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xl font-bold text-green-900 mt-1\",children:ticketStats.used})]}),/*#__PURE__*/_jsx(\"div\",{className:\"p-2 rounded-full bg-green-100\",children:/*#__PURE__*/_jsx(FiCheckCircle,{className:\"h-5 w-5 text-green-700\"})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-amber-50 rounded-lg p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-amber-800 font-medium\",children:\"Tickets Restants\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xl font-bold text-amber-900 mt-1\",children:ticketStats.remaining})]}),/*#__PURE__*/_jsx(\"div\",{className:\"p-2 rounded-full bg-amber-100\",children:/*#__PURE__*/_jsx(FiXCircle,{className:\"h-5 w-5 text-amber-700\"})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-purple-50 rounded-lg p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-purple-800 font-medium\",children:\"Taux de Conversion\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-xl font-bold text-purple-900 mt-1\",children:[usageRate,\"%\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"p-2 rounded-full bg-purple-100\",children:/*#__PURE__*/_jsx(FiTrendingUp,{className:\"h-5 w-5 text-purple-700\"})})]})})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:`bg-white rounded-xl shadow-md border border-gray-100 ${!hasValidTicketStats?\"lg:col-span-2\":\"\"}`,children:[/*#__PURE__*/_jsx(\"div\",{className:\"px-6 py-4 border-b border-gray-200\",children:/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-800\",children:\"Activit\\xE9 R\\xE9cente\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"p-4\",children:recentGains.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"divide-y divide-gray-200\",children:recentGains.map((gain,index)=>{var _gain$user;return/*#__PURE__*/_jsxs(\"div\",{className:\"py-3 flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center text-blue-700\",children:/*#__PURE__*/_jsx(FiGift,{className:\"h-5 w-5\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"ml-3\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-gray-900\",children:((_gain$user=gain.user)===null||_gain$user===void 0?void 0:_gain$user.userName)||\"Utilisateur\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-gray-500\",children:[\"a gagn\\xE9 \",gain.prizeWon||\"un prix\"]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-500\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(FiCalendar,{className:\"mr-1 h-4 w-4\"}),formatDate(gain.createdAt)]})})]},index);})}):/*#__PURE__*/_jsx(\"div\",{className:\"py-4 text-center text-gray-500\",children:\"Aucune activit\\xE9 r\\xE9cente \\xE0 afficher\"})})]})]})]});};// Render Prizes Tab\nconst renderPrizesTab=()=>{// Get prize and ticket data from gameStats if available\nconst prizeDistributionData=gameStats&&gameStats.prizeDistribution&&gameStats.prizeDistribution.length>0?gameStats.prizeDistribution:null;const ticketStats=gameStats&&gameStats.ticketStats&&(gameStats.ticketStats.used>0||gameStats.ticketStats.remaining>0)?gameStats.ticketStats:null;const totalTickets=ticketStats?ticketStats.used+ticketStats.remaining:0;const usageRate=totalTickets>0?Math.round(ticketStats.used/totalTickets*100):0;// Check for valid data for this tab\nconst hasValidDataForTab=prizeDistributionData||ticketStats;// If no data is available, show a message\nif(!hasValidDataForTab){return/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-xl shadow-md border border-gray-100 p-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"py-12 text-center\",children:[/*#__PURE__*/_jsx(FiPackage,{className:\"h-12 w-12 mx-auto text-gray-400 mb-4\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-gray-900 mb-2\",children:\"Aucune donn\\xE9e disponible\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:\"Les informations sur les prix et tickets ne sont pas encore disponibles.\"})]})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl shadow-md border border-gray-100 p-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-800 mb-4\",children:\"Distribution des Prix et Statistiques des Tickets\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-8\",children:[prizeDistributionData&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-md font-medium text-gray-700 mb-4\",children:\"Distribution des Prix\"}),/*#__PURE__*/_jsx(\"div\",{className:\"h-64\",children:/*#__PURE__*/_jsx(PrizeDistributionChart,{data:prizeDistributionData})}),gameStats&&gameStats.totalPrizeCount&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-6 space-y-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-gray-50 p-4 rounded-lg\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-gray-500\",children:\"Nombre total de prix\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xl font-bold text-gray-800\",children:gameStats.totalPrizeCount})]}),/*#__PURE__*/_jsx(\"div\",{className:\"p-2 rounded-full bg-blue-100 text-blue-800\",children:/*#__PURE__*/_jsx(FiPackage,{className:\"h-5 w-5\"})})]})}),gameStats.totalPrizeValue&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-gray-50 p-4 rounded-lg\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-gray-500\",children:\"Valeur totale\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-xl font-bold text-gray-800\",children:[gameStats.totalPrizeValue,\" \\u20AC\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"p-2 rounded-full bg-purple-100 text-purple-800\",children:/*#__PURE__*/_jsx(FiDollarSign,{className:\"h-5 w-5\"})})]})})]})]}),ticketStats&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-md font-medium text-gray-700 mb-4\",children:\"Utilisation des Tickets\"}),/*#__PURE__*/_jsx(\"div\",{className:\"h-64\",children:/*#__PURE__*/_jsx(TicketUsageChart,{data:[{name:\"Utilisés\",value:ticketStats.used},{name:\"Non utilisés\",value:ticketStats.remaining}]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-6 space-y-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-gray-50 p-4 rounded-lg\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-gray-500\",children:\"Tickets utilis\\xE9s\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xl font-bold text-gray-800\",children:ticketStats.used})]}),/*#__PURE__*/_jsx(\"div\",{className:\"p-2 rounded-full bg-green-100 text-green-800\",children:/*#__PURE__*/_jsx(FiCheckCircle,{className:\"h-5 w-5\"})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-gray-50 p-4 rounded-lg\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-gray-500\",children:\"Tickets restants\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xl font-bold text-gray-800\",children:ticketStats.remaining})]}),/*#__PURE__*/_jsx(\"div\",{className:\"p-2 rounded-full bg-amber-100 text-amber-800\",children:/*#__PURE__*/_jsx(FiXCircle,{className:\"h-5 w-5\"})})]})})]})]})]}),gameStats&&gameStats.gains&&gameStats.gains.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-8\",children:/*#__PURE__*/_jsxs(\"h4\",{className:\"text-md font-medium text-gray-700 mb-4\",children:[\"Liste des Prix Distribu\\xE9s (\",gameStats.gains.length,\")\"]})})]});};return/*#__PURE__*/_jsx(DashboardLayout,{userType:\"admin\",children:loading?/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center items-center h-full\",children:/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600\"})}):error?/*#__PURE__*/_jsx(\"div\",{className:\"bg-red-100 border-l-4 border-red-500 text-red-700 p-4 mb-6 rounded-md\",children:/*#__PURE__*/_jsx(\"p\",{children:error})}):/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold text-gray-900\",children:\"Tableau de Bord Administrateur\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-blue-50 px-4 py-2 rounded-lg text-blue-800 text-sm font-medium flex items-center\",children:[/*#__PURE__*/_jsx(FiClock,{className:\"mr-2\"}),\"Derni\\xE8re mise \\xE0 jour: \",new Date().toLocaleTimeString()]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"border-b border-gray-200\",children:/*#__PURE__*/_jsxs(\"nav\",{className:\"-mb-px flex\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveTab(\"overview\"),className:`px-4 py-2 font-medium text-sm ${activeTab===\"overview\"?\"border-b-2 border-blue-500 text-blue-600\":\"text-gray-500 hover:text-gray-700 hover:border-gray-300\"}`,children:\"Vue d'ensemble\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveTab(\"users\"),className:`ml-8 px-4 py-2 font-medium text-sm ${activeTab===\"users\"?\"border-b-2 border-blue-500 text-blue-600\":\"text-gray-500 hover:text-gray-700 hover:border-gray-300\"}`,children:\"Utilisateurs\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveTab(\"prizes\"),className:`ml-8 px-4 py-2 font-medium text-sm ${activeTab===\"prizes\"?\"border-b-2 border-blue-500 text-blue-600\":\"text-gray-500 hover:text-gray-700 hover:border-gray-300\"}`,children:\"Prix & Tickets\"})]})}),/*#__PURE__*/_jsxs(\"div\",{children:[activeTab===\"overview\"&&renderOverview(),activeTab===\"users\"&&renderUsersTab(),activeTab===\"prizes\"&&renderPrizesTab()]}),showUserModal&&/*#__PURE__*/_jsx(UserDetailsModal,{})]})});};export default AdminDashboard;","map":{"version":3,"names":["React","useState","useEffect","axios","DashboardLayout","PrizeDistributionChart","TicketUsageChart","UserActivityChart","FiUsers","FiUserCheck","FiPackage","FiDollarSign","FiPieChart","FiTrendingUp","FiCalendar","FiClock","FiCheckCircle","FiXCircle","FiGift","FiLock","FiUnlock","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","API_URL","process","env","REACT_APP_API_URL","AdminDashboard","loading","setLoading","error","setError","users","setUsers","clients","setClients","employees","setEmployees","gameStats","setGameStats","activeTab","setActiveTab","selectedFilter","setSelectedFilter","showUserModal","setShowUserModal","selectedUser","setSelectedUser","fetchData","token","localStorage","getItem","userProfileResponse","get","headers","Authorization","userProfile","data","user","userType","usersRes","clientsRes","employeesRes","gameStatsRes","Promise","all","employers","err","_err$response","console","response","status","_err$response2","_err$response2$data","message","formatDate","dateString","options","year","month","day","Date","toLocaleDateString","undefined","handleLogoutUser","userId","post","updatedUsers","map","_id","isActive","_err$response3","_err$response3$data","alert","toggleGameAccess","currentAccess","newAccess","put","gameAccess","_err$response4","_err$response4$data","showUserDetails","UserDetailsModal","_selectedUser$userNam","_selectedUser$address","className","children","onClick","fill","strokeLinecap","strokeLinejoin","strokeWidth","viewBox","stroke","d","userName","charAt","toUpperCase","email","phone","address","join","createdAt","updatedAt","renderUsersTab","filteredUsers","filter","value","onChange","e","target","slice","_user$userName","Math","min","length","renderOverview","userActivityData","name","ticketUsageData","ticketStats","used","remaining","prizeDistributionData","prizeDistribution","totalUsers","clientCount","employeeCount","adminCount","u","recentGains","gains","totalTickets","usageRate","round","hasValidTicketStats","hasValidPrizeData","totalPrizeValue","style","width","gain","index","_gain$user","prizeWon","renderPrizesTab","hasValidDataForTab","totalPrizeCount","toLocaleTimeString"],"sources":["D:/Projet/Nouveau dossier/THETIPTOP_GAME/frontend/src/pages/Dashbords/AdminDashboard.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport axios from \"axios\";\r\nimport DashboardLayout from \"../../components/DashboardLayout\";\r\nimport PrizeDistributionChart from \"../../components/PrizeDistributionChart\";\r\nimport TicketUsageChart from \"../../components/TicketUsageChart\";\r\nimport UserActivityChart from \"../../components/UserActivityChart\";\r\n// import { useNavigate } from \"react-router-dom\";\r\nimport {\r\n  FiUsers,\r\n  FiUserCheck,\r\n  FiPackage,\r\n  FiDollarSign,\r\n  FiPieChart,\r\n  FiTrendingUp,\r\n  FiCalendar,\r\n  FiClock,\r\n  FiCheckCircle,\r\n  FiXCircle,\r\n  FiGift,\r\n  FiLock,\r\n  FiUnlock,\r\n} from \"react-icons/fi\";\r\n\r\n\r\nconst API_URL = process.env.REACT_APP_API_URL || \"http://localhost:4000/api\"; // Correction ici\r\n\r\nconst AdminDashboard = () => {\r\n  // State variables for data\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const [users, setUsers] = useState([]);\r\n  const [clients, setClients] = useState([]);\r\n  const [employees, setEmployees] = useState([]);\r\n  const [gameStats, setGameStats] = useState(null);\r\n  const [activeTab, setActiveTab] = useState(\"overview\");\r\n  const [selectedFilter, setSelectedFilter] = useState(\"all\");\r\n  // const navigate = useNavigate();\r\n\r\n  // State for user details modal\r\n  const [showUserModal, setShowUserModal] = useState(false);\r\n  const [selectedUser, setSelectedUser] = useState(null);\r\n\r\n  // Fetch data from backend on component mount\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      setLoading(true);\r\n      setError(null);\r\n\r\n      const token = localStorage.getItem(\"token\");\r\n      if (!token) {\r\n        setError(\"Authentication token not found. Please log in again.\");\r\n        setLoading(false);\r\n        return;\r\n      }\r\n\r\n      try {\r\n        // Vérification des permissions admin avant récupération des données\r\n        const userProfileResponse = await axios.get(`${API_URL}/user/userprofile`, {\r\n          headers: { Authorization: `Bearer ${token}` },\r\n        });\r\n\r\n        const userProfile = userProfileResponse.data.user;\r\n        if (userProfile.userType !== \"admin\") {\r\n          setError(\"Access forbidden: insufficient permissions. Admin access required.\");\r\n          setLoading(false);\r\n          return;\r\n        }\r\n\r\n        const headers = { Authorization: `Bearer ${token}` };\r\n\r\n        // Chargement des données uniquement si l'utilisateur est un admin\r\n        const [usersRes, clientsRes, employeesRes, gameStatsRes] = await Promise.all([\r\n          axios.get(`${API_URL}/user/allusers`, { headers }),\r\n          axios.get(`${API_URL}/user/allclients`, { headers }),\r\n          axios.get(`${API_URL}/user/allemployers`, { headers }),\r\n          axios.get(`${API_URL}/user/usersgains`, { headers }),\r\n        ]);\r\n\r\n        setUsers(usersRes.data.users || []);\r\n        setClients(clientsRes.data.clients || []);\r\n        setEmployees(employeesRes.data.employers || []);\r\n        setGameStats(gameStatsRes.data || {});\r\n      } catch (err) {\r\n        console.error(\"Error fetching dashboard data:\", err);\r\n        if (err.response?.status === 403) {\r\n          setError(\"Access forbidden: insufficient permissions. Admin access required.\");\r\n        } else {\r\n          setError(err.response?.data?.message || \"Failed to fetch dashboard data\");\r\n        }\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchData();\r\n  }, []);\r\n\r\n  // Formatage des dates pour l'affichage\r\n  const formatDate = (dateString) => {\r\n    const options = { year: \"numeric\", month: \"short\", day: \"numeric\" };\r\n    return new Date(dateString).toLocaleDateString(undefined, options);\r\n  };\r\n\r\n  // Déconnexion utilisateur\r\n  const handleLogoutUser = async (userId) => {\r\n    try {\r\n      const token = localStorage.getItem(\"token\");\r\n      await axios.post(`${API_URL}/user/logoutuser/${userId}`, {}, {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      });\r\n\r\n      // alert(\"L'utilisateur a été déconnecté avec succès\");\r\n\r\n      // Rafraîchir la liste des utilisateurs\r\n      const updatedUsers = users.map((user) => {\r\n        if (user._id === userId) {\r\n          return { ...user, isActive: false };\r\n        }\r\n        return user;\r\n      });\r\n      setUsers(updatedUsers);\r\n    } catch (err) {\r\n      alert(\"Erreur lors de la déconnexion de l'utilisateur: \" + (err.response?.data?.message || err.message));\r\n    }\r\n  };\r\n\r\n  // Gestion de l'accès au jeu pour les utilisateurs\r\n  const toggleGameAccess = async (userId, currentAccess) => {\r\n    try {\r\n      const token = localStorage.getItem(\"token\");\r\n      const newAccess = !currentAccess;\r\n\r\n      await axios.put(`${API_URL}/user/updateuser/${userId}`, { gameAccess: newAccess }, {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      });\r\n\r\n      // Mise à jour de l'état local des utilisateurs\r\n      const updatedUsers = users.map((user) => {\r\n        if (user._id === userId) {\r\n          return { ...user, gameAccess: newAccess };\r\n        }\r\n        return user;\r\n      });\r\n\r\n      setUsers(updatedUsers);\r\n\r\n      // Si la fenêtre modale est ouverte, mise à jour de l'utilisateur sélectionné\r\n      if (selectedUser && selectedUser._id === userId) {\r\n        setSelectedUser({ ...selectedUser, gameAccess: newAccess });\r\n      }\r\n\r\n      alert(`L'accès au jeu a été ${newAccess ? \"activé\" : \"désactivé\"} pour cet utilisateur`);\r\n    } catch (err) {\r\n      alert(\"Erreur lors de la modification d'accès au jeu: \" + (err.response?.data?.message || err.message));\r\n    }\r\n  };\r\n\r\n  // Show user details modal\r\n  const showUserDetails = (user) => {\r\n    setSelectedUser(user);\r\n    setShowUserModal(true);\r\n  };\r\n\r\n  // User details modal\r\n  const UserDetailsModal = () => {\r\n    if (!selectedUser) return null;\r\n\r\n    return (\r\n      <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n        <div className=\"bg-white rounded-lg p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto\">\r\n          <div className=\"flex justify-between items-start mb-6\">\r\n            <h2 className=\"text-2xl font-bold text-gray-900\">\r\n              Détails de l'utilisateur\r\n            </h2>\r\n            <button\r\n              onClick={() => setShowUserModal(false)}\r\n              className=\"text-gray-500 hover:text-gray-700\"\r\n            >\r\n              <svg\r\n                className=\"w-6 h-6\"\r\n                fill=\"none\"\r\n                strokeLinecap=\"round\"\r\n                strokeLinejoin=\"round\"\r\n                strokeWidth=\"2\"\r\n                viewBox=\"0 0 24 24\"\r\n                stroke=\"currentColor\"\r\n              >\r\n                <path d=\"M6 18L18 6M6 6l12 12\"></path>\r\n              </svg>\r\n            </button>\r\n          </div>\r\n\r\n          <div className=\"flex items-center mb-8\">\r\n            <div className=\"h-20 w-20 rounded-full bg-gray-200 flex items-center justify-center text-gray-700 font-semibold text-3xl\">\r\n              {selectedUser.userName?.charAt(0).toUpperCase() || \"?\"}\r\n            </div>\r\n            <div className=\"ml-6\">\r\n              <h3 className=\"text-xl font-semibold\">{selectedUser.userName}</h3>\r\n              <p className=\"text-gray-600\">{selectedUser.email}</p>\r\n              <div className=\"mt-1\">\r\n                <span\r\n                  className={`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full \r\n                  ${\r\n                    selectedUser.userType === \"admin\"\r\n                      ? \"bg-purple-100 text-purple-800\"\r\n                      : selectedUser.userType === \"client\"\r\n                        ? \"bg-green-100 text-green-800\"\r\n                        : \"bg-blue-100 text-blue-800\"\r\n                  }`}\r\n                >\r\n                  {selectedUser.userType === \"admin\"\r\n                    ? \"Administrateur\"\r\n                    : selectedUser.userType === \"client\"\r\n                      ? \"Client\"\r\n                      : \"Employé\"}\r\n                </span>\r\n                <span\r\n                  className={`ml-2 px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full \r\n                  ${\r\n                    selectedUser.gameAccess === false\r\n                      ? \"bg-red-100 text-red-800\"\r\n                      : \"bg-green-100 text-green-800\"\r\n                  }`}\r\n                >\r\n                  {selectedUser.gameAccess === false\r\n                    ? \"Accès au jeu bloqué\"\r\n                    : \"Accès au jeu autorisé\"}\r\n                </span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8\">\r\n            <div>\r\n              <h4 className=\"text-sm font-medium text-gray-500 mb-2\">\r\n                Coordonnées\r\n              </h4>\r\n              <div className=\"bg-gray-50 p-4 rounded-lg\">\r\n                <p className=\"text-sm mb-2\">\r\n                  <span className=\"font-medium\">Téléphone:</span>{\" \"}\r\n                  {selectedUser.phone}\r\n                </p>\r\n                <p className=\"text-sm mb-2\">\r\n                  <span className=\"font-medium\">Adresse:</span>{\" \"}\r\n                  {selectedUser.address?.join(\", \") || \"Non spécifiée\"}\r\n                </p>\r\n              </div>\r\n            </div>\r\n            <div>\r\n              <h4 className=\"text-sm font-medium text-gray-500 mb-2\">\r\n                Informations du compte\r\n              </h4>\r\n              <div className=\"bg-gray-50 p-4 rounded-lg\">\r\n                <p className=\"text-sm mb-2\">\r\n                  <span className=\"font-medium\">Inscrit le:</span>{\" \"}\r\n                  {formatDate(selectedUser.createdAt)}\r\n                </p>\r\n                <p className=\"text-sm mb-2\">\r\n                  <span className=\"font-medium\">Mis à jour le:</span>{\" \"}\r\n                  {formatDate(selectedUser.updatedAt)}\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"flex justify-between border-t pt-6\">\r\n            <button\r\n              onClick={() =>\r\n                toggleGameAccess(selectedUser._id, selectedUser.gameAccess)\r\n              }\r\n              className={`flex items-center px-4 py-2 rounded-md text-sm font-medium ${\r\n                selectedUser.gameAccess\r\n                  ? \"bg-red-100 text-red-800 hover:bg-red-200\"\r\n                  : \"bg-green-100 text-green-800 hover:bg-green-200\"\r\n              }`}\r\n            >\r\n              {selectedUser.gameAccess ? (\r\n                <>\r\n                  <FiLock className=\"mr-2\" />\r\n                  Bloquer l'accès au jeu\r\n                </>\r\n              ) : (\r\n                <>\r\n                  <FiUnlock className=\"mr-2\" />\r\n                  Autoriser l'accès au jeu\r\n                </>\r\n              )}\r\n            </button>\r\n            <div>\r\n              <button\r\n                onClick={() => handleLogoutUser(selectedUser._id)}\r\n                className=\"bg-red-100 text-red-800 hover:bg-red-200 px-4 py-2 rounded-md text-sm font-medium ml-2\"\r\n              >\r\n                Déconnecter\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  // Render Users Tab\r\n  const renderUsersTab = () => {\r\n    let filteredUsers = users;\r\n\r\n    if (selectedFilter === \"client\") {\r\n      filteredUsers = users.filter((user) => user.userType === \"client\");\r\n    } else if (selectedFilter === \"employee\") {\r\n      filteredUsers = users.filter((user) => user.userType === \"employer\");\r\n    } else if (selectedFilter === \"admin\") {\r\n      filteredUsers = users.filter((user) => user.userType === \"admin\");\r\n    }\r\n\r\n    return (\r\n      <div className=\"bg-white rounded-xl shadow-md border border-gray-100 overflow-hidden\">\r\n        <div className=\"px-6 py-4 border-b border-gray-200 flex justify-between items-center\">\r\n          <h3 className=\"text-lg font-semibold text-gray-800\">\r\n            Gestion des Utilisateurs\r\n          </h3>\r\n          <div className=\"flex\">\r\n            <select\r\n              className=\"px-4 py-2 border border-gray-300 rounded-md bg-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n              value={selectedFilter}\r\n              onChange={(e) => setSelectedFilter(e.target.value)}\r\n            >\r\n              <option value=\"all\">Tous les Utilisateurs</option>\r\n              <option value=\"client\">Clients Seulement</option>\r\n              <option value=\"employee\">Employés Seulement</option>\r\n              <option value=\"admin\">Admins Seulement</option>\r\n            </select>\r\n          </div>\r\n        </div>\r\n        <div className=\"px-6 overflow-x-auto\">\r\n          <table className=\"min-w-full divide-y divide-gray-200\">\r\n            <thead>\r\n              <tr>\r\n                <th className=\"px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                  Nom\r\n                </th>\r\n                <th className=\"px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                  Email\r\n                </th>\r\n                <th className=\"px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                  Type d'Utilisateur\r\n                </th>\r\n                <th className=\"px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                  Accès au jeu\r\n                </th>\r\n                <th className=\"px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                  Inscrit le\r\n                </th>\r\n                <th className=\"px-6 py-3 bg-gray-50 text-right text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                  Actions\r\n                </th>\r\n              </tr>\r\n            </thead>\r\n            <tbody className=\"bg-white divide-y divide-gray-200\">\r\n              {filteredUsers.slice(0, 10).map((user) => (\r\n                <tr key={user._id} className=\"hover:bg-gray-50\">\r\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                    <div className=\"flex items-center\">\r\n                      <div className=\"h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center text-gray-700 font-semibold\">\r\n                        {user.userName?.charAt(0).toUpperCase() || \"?\"}\r\n                      </div>\r\n                      <div className=\"ml-4\">\r\n                        <div className=\"text-sm font-medium text-gray-900\">\r\n                          {user.userName}\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </td>\r\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\r\n                    {user.email}\r\n                  </td>\r\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                    <span\r\n                      className={`px-2 inline-flex text-xs leading-5 font-semibold rounded-full \r\n                      ${\r\n                        user.userType === \"admin\"\r\n                          ? \"bg-purple-100 text-purple-800\"\r\n                          : user.userType === \"client\"\r\n                            ? \"bg-green-100 text-green-800\"\r\n                            : \"bg-blue-100 text-blue-800\"\r\n                      }`}\r\n                    >\r\n                      {user.userType === \"admin\"\r\n                        ? \"Administrateur\"\r\n                        : user.userType === \"client\"\r\n                          ? \"Client\"\r\n                          : \"Employé\"}\r\n                    </span>\r\n                  </td>\r\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                    <span\r\n                      className={`px-2 inline-flex text-xs leading-5 font-semibold rounded-full \r\n                      ${\r\n                        user.gameAccess === false\r\n                          ? \"bg-red-100 text-red-800\"\r\n                          : \"bg-green-100 text-green-800\"\r\n                      }`}\r\n                    >\r\n                      {user.gameAccess === false ? \"Bloqué\" : \"Autorisé\"}\r\n                    </span>\r\n                  </td>\r\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\r\n                    <div className=\"flex items-center\">\r\n                      <FiClock className=\"mr-2 text-gray-400\" />\r\n                      {formatDate(user.createdAt)}\r\n                    </div>\r\n                  </td>\r\n                  <td className=\"px-6 py-4 whitespace-nowrap text-right text-sm font-medium\">\r\n                    <button\r\n                      className=\"text-blue-600 hover:text-blue-900 mr-3\"\r\n                      onClick={() => showUserDetails(user)}\r\n                    >\r\n                      Voir\r\n                    </button>\r\n                    <button\r\n                      className=\"text-red-600 hover:text-red-900\"\r\n                      onClick={() => handleLogoutUser(user._id)}\r\n                    >\r\n                      Déconnecter\r\n                    </button>\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n        <div className=\"px-6 py-4 border-t border-gray-200 flex justify-between items-center\">\r\n          <div className=\"text-sm text-gray-700\">\r\n            Affichage de <span className=\"font-medium\">1</span> à{\" \"}\r\n            <span className=\"font-medium\">\r\n              {Math.min(filteredUsers.length, 10)}\r\n            </span>{\" \"}\r\n            sur <span className=\"font-medium\">{filteredUsers.length}</span>{\" \"}\r\n            résultats\r\n          </div>\r\n          <div className=\"flex space-x-2\">\r\n            <button className=\"px-3 py-1 border border-gray-300 bg-white text-gray-500 text-sm rounded-md disabled:opacity-50\">\r\n              Précédent\r\n            </button>\r\n            <button className=\"px-3 py-1 border border-gray-300 bg-white text-gray-500 text-sm rounded-md hover:bg-gray-50 disabled:opacity-50\">\r\n              Suivant\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  // Render Dashboard Overview\r\n  const renderOverview = () => {\r\n    // Format data for charts\r\n    const userActivityData = [\r\n      { name: \"Jan\", value: 28 },\r\n      { name: \"Fév\", value: 45 },\r\n      { name: \"Mar\", value: 32 },\r\n      { name: \"Avr\", value: 56 },\r\n      { name: \"Mai\", value: 78 },\r\n      { name: \"Juin\", value: 63 },\r\n    ];\r\n\r\n    // Only use real ticket data if available\r\n    const ticketUsageData =\r\n      gameStats && gameStats.ticketStats && gameStats.ticketStats.used > 0\r\n        ? [\r\n            { name: \"Utilisés\", value: gameStats.ticketStats.used || 0 },\r\n            {\r\n              name: \"Non utilisés\",\r\n              value: gameStats.ticketStats.remaining || 0,\r\n            },\r\n          ]\r\n        : null;\r\n\r\n    // Only use real prize data if available\r\n    const prizeDistributionData =\r\n      gameStats &&\r\n      gameStats.prizeDistribution &&\r\n      gameStats.prizeDistribution.length > 0\r\n        ? gameStats.prizeDistribution\r\n        : null;\r\n\r\n    // Calculate some statistics\r\n    let totalUsers = users.length || 0;\r\n    let clientCount = clients.length || 0;\r\n    let employeeCount = employees.length || 0;\r\n    let adminCount = users.filter((u) => u.userType === \"admin\").length || 0;\r\n\r\n    // Calculate recent gains if data available\r\n    let recentGains = [];\r\n    if (gameStats && gameStats.gains) {\r\n      recentGains = gameStats.gains.slice(0, 5);\r\n    }\r\n\r\n    // Calculate ticket stats\r\n    const ticketStats =\r\n      gameStats &&\r\n      gameStats.ticketStats &&\r\n      (gameStats.ticketStats.used > 0 || gameStats.ticketStats.remaining > 0)\r\n        ? gameStats.ticketStats\r\n        : null;\r\n    const totalTickets = ticketStats\r\n      ? ticketStats.used + ticketStats.remaining\r\n      : 0;\r\n    const usageRate =\r\n      totalTickets > 0\r\n        ? Math.round((ticketStats.used / totalTickets) * 100)\r\n        : 0;\r\n\r\n    // Check if we have valid ticket data to display\r\n    const hasValidTicketStats = ticketStats && totalTickets > 0;\r\n    const hasValidPrizeData =\r\n      prizeDistributionData && prizeDistributionData.length > 0;\r\n\r\n    return (\r\n      <div className=\"space-y-6\">\r\n        {/* Stats Overview */}\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\r\n          {/* Total Users */}\r\n          <div className=\"bg-white rounded-xl shadow-md p-6 transition-all duration-200 hover:shadow-lg border border-gray-100\">\r\n            <div className=\"flex justify-between items-start\">\r\n              <div>\r\n                <p className=\"text-sm text-gray-500 font-medium\">\r\n                  Total Utilisateurs\r\n                </p>\r\n                <p className=\"text-2xl font-bold text-gray-800 mt-1\">\r\n                  {totalUsers}\r\n                </p>\r\n              </div>\r\n              <div className=\"p-3 rounded-full bg-blue-100 text-blue-600\">\r\n                <FiUsers className=\"h-6 w-6\" />\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Active Clients */}\r\n          <div className=\"bg-white rounded-xl shadow-md p-6 transition-all duration-200 hover:shadow-lg border border-gray-100\">\r\n            <div className=\"flex justify-between items-start\">\r\n              <div>\r\n                <p className=\"text-sm text-gray-500 font-medium\">\r\n                  Clients Actifs\r\n                </p>\r\n                <p className=\"text-2xl font-bold text-gray-800 mt-1\">\r\n                  {clientCount}\r\n                </p>\r\n              </div>\r\n              <div className=\"p-3 rounded-full bg-green-100 text-green-600\">\r\n                <FiUserCheck className=\"h-6 w-6\" />\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Total Prize Value or Employee Count */}\r\n          {gameStats && gameStats.totalPrizeValue ? (\r\n            <div className=\"bg-white rounded-xl shadow-md p-6 transition-all duration-200 hover:shadow-lg border border-gray-100\">\r\n              <div className=\"flex justify-between items-start\">\r\n                <div>\r\n                  <p className=\"text-sm text-gray-500 font-medium\">\r\n                    Valeur Totale des Prix\r\n                  </p>\r\n                  <p className=\"text-2xl font-bold text-gray-800 mt-1\">\r\n                    {gameStats.totalPrizeValue} €\r\n                  </p>\r\n                </div>\r\n                <div className=\"p-3 rounded-full bg-purple-100 text-purple-600\">\r\n                  <FiPackage className=\"h-6 w-6\" />\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ) : (\r\n            <div className=\"bg-white rounded-xl shadow-md p-6 transition-all duration-200 hover:shadow-lg border border-gray-100\">\r\n              <div className=\"flex justify-between items-start\">\r\n                <div>\r\n                  <p className=\"text-sm text-gray-500 font-medium\">Employés</p>\r\n                  <p className=\"text-2xl font-bold text-gray-800 mt-1\">\r\n                    {employeeCount}\r\n                  </p>\r\n                </div>\r\n                <div className=\"p-3 rounded-full bg-blue-100 text-blue-600\">\r\n                  <FiUserCheck className=\"h-6 w-6\" />\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Ticket Usage Rate or Admin Count */}\r\n          {hasValidTicketStats ? (\r\n            <div className=\"bg-white rounded-xl shadow-md p-6 transition-all duration-200 hover:shadow-lg border border-gray-100\">\r\n              <div className=\"flex justify-between items-start\">\r\n                <div>\r\n                  <p className=\"text-sm text-gray-500 font-medium\">\r\n                    Taux d'Utilisation des Tickets\r\n                  </p>\r\n                  <p className=\"text-2xl font-bold text-gray-800 mt-1\">\r\n                    {usageRate}%\r\n                  </p>\r\n                </div>\r\n                <div className=\"p-3 rounded-full bg-amber-100 text-amber-600\">\r\n                  <FiPieChart className=\"h-6 w-6\" />\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ) : (\r\n            <div className=\"bg-white rounded-xl shadow-md p-6 transition-all duration-200 hover:shadow-lg border border-gray-100\">\r\n              <div className=\"flex justify-between items-start\">\r\n                <div>\r\n                  <p className=\"text-sm text-gray-500 font-medium\">\r\n                    Administrateurs\r\n                  </p>\r\n                  <p className=\"text-2xl font-bold text-gray-800 mt-1\">\r\n                    {adminCount}\r\n                  </p>\r\n                </div>\r\n                <div className=\"p-3 rounded-full bg-purple-100 text-purple-600\">\r\n                  <FiUserCheck className=\"h-6 w-6\" />\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Charts Overview */}\r\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\r\n          <div\r\n            className={`bg-white rounded-xl shadow-md border border-gray-100 col-span-1 ${hasValidTicketStats && ticketUsageData ? \"lg:col-span-2\" : \"lg:col-span-3\"}`}\r\n          >\r\n            <div className=\"px-6 py-4 border-b border-gray-200\">\r\n              <h3 className=\"text-lg font-semibold text-gray-800\">\r\n                Tendance d'Activité des Utilisateurs\r\n              </h3>\r\n            </div>\r\n            <div className=\"p-4 h-72\">\r\n              <UserActivityChart data={userActivityData} />\r\n            </div>\r\n          </div>\r\n\r\n          {/* Only show ticket usage chart if we have valid data */}\r\n          {hasValidTicketStats && ticketUsageData && (\r\n            <div className=\"bg-white rounded-xl shadow-md border border-gray-100\">\r\n              <div className=\"px-6 py-4 border-b border-gray-200\">\r\n                <h3 className=\"text-lg font-semibold text-gray-800\">\r\n                  Utilisation des Tickets\r\n                </h3>\r\n              </div>\r\n              <div className=\"p-4 h-72\">\r\n                <TicketUsageChart data={ticketUsageData} />\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* User Composition and Prize Distribution */}\r\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\r\n          <div\r\n            className={`bg-white rounded-xl shadow-md border border-gray-100 ${!hasValidPrizeData ? \"lg:col-span-2\" : \"\"}`}\r\n          >\r\n            <div className=\"px-6 py-4 border-b border-gray-200\">\r\n              <h3 className=\"text-lg font-semibold text-gray-800\">\r\n                Composition des Utilisateurs\r\n              </h3>\r\n            </div>\r\n            <div className=\"p-6\">\r\n              <div className=\"space-y-4\">\r\n                {/* Admin users */}\r\n                <div className=\"flex items-center\">\r\n                  <div className=\"w-full\">\r\n                    <div className=\"flex justify-between mb-1\">\r\n                      <span className=\"text-sm font-medium text-gray-700\">\r\n                        Admin\r\n                      </span>\r\n                      <span className=\"text-sm font-medium text-gray-700\">\r\n                        {users.filter((u) => u.userType === \"admin\").length} (\r\n                        {Math.round(\r\n                          (users.filter((u) => u.userType === \"admin\").length /\r\n                            users.length) *\r\n                            100\r\n                        )}\r\n                        %)\r\n                      </span>\r\n                    </div>\r\n                    <div className=\"w-full bg-gray-100 rounded-full h-2.5\">\r\n                      <div\r\n                        className=\"bg-purple-600 h-2.5 rounded-full\"\r\n                        style={{\r\n                          width: `${users.length ? (users.filter((u) => u.userType === \"admin\").length / users.length) * 100 : 0}%`,\r\n                        }}\r\n                      ></div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Client users */}\r\n                <div className=\"flex items-center\">\r\n                  <div className=\"w-full\">\r\n                    <div className=\"flex justify-between mb-1\">\r\n                      <span className=\"text-sm font-medium text-gray-700\">\r\n                        Clients\r\n                      </span>\r\n                      <span className=\"text-sm font-medium text-gray-700\">\r\n                        {users.filter((u) => u.userType === \"client\").length} (\r\n                        {Math.round(\r\n                          (users.filter((u) => u.userType === \"client\").length /\r\n                            users.length) *\r\n                            100\r\n                        )}\r\n                        %)\r\n                      </span>\r\n                    </div>\r\n                    <div className=\"w-full bg-gray-100 rounded-full h-2.5\">\r\n                      <div\r\n                        className=\"bg-green-600 h-2.5 rounded-full\"\r\n                        style={{\r\n                          width: `${users.length ? (users.filter((u) => u.userType === \"client\").length / users.length) * 100 : 0}%`,\r\n                        }}\r\n                      ></div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Employee users */}\r\n                <div className=\"flex items-center\">\r\n                  <div className=\"w-full\">\r\n                    <div className=\"flex justify-between mb-1\">\r\n                      <span className=\"text-sm font-medium text-gray-700\">\r\n                        Employés\r\n                      </span>\r\n                      <span className=\"text-sm font-medium text-gray-700\">\r\n                        {users.filter((u) => u.userType === \"employer\").length}{\" \"}\r\n                        (\r\n                        {Math.round(\r\n                          (users.filter((u) => u.userType === \"employer\")\r\n                            .length /\r\n                            users.length) *\r\n                            100\r\n                        )}\r\n                        %)\r\n                      </span>\r\n                    </div>\r\n                    <div className=\"w-full bg-gray-100 rounded-full h-2.5\">\r\n                      <div\r\n                        className=\"bg-blue-600 h-2.5 rounded-full\"\r\n                        style={{\r\n                          width: `${users.length ? (users.filter((u) => u.userType === \"employer\").length / users.length) * 100 : 0}%`,\r\n                        }}\r\n                      ></div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Prize Distribution Chart - Only show if valid data */}\r\n          {hasValidPrizeData && (\r\n            <div className=\"bg-white rounded-xl shadow-md border border-gray-100\">\r\n              <div className=\"px-6 py-4 border-b border-gray-200\">\r\n                <h3 className=\"text-lg font-semibold text-gray-800\">\r\n                  Distribution des Prix\r\n                </h3>\r\n              </div>\r\n              <div className=\"p-4 h-72\">\r\n                <PrizeDistributionChart data={prizeDistributionData} />\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Ticket Stats and Recent Activity */}\r\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\r\n          {/* Only show ticket stats if we have valid data */}\r\n          {hasValidTicketStats && (\r\n            <div className=\"bg-white rounded-xl shadow-md border border-gray-100\">\r\n              <div className=\"px-6 py-4 border-b border-gray-200\">\r\n                <h3 className=\"text-lg font-semibold text-gray-800\">\r\n                  Statistiques des Tickets\r\n                </h3>\r\n              </div>\r\n              <div className=\"p-6\">\r\n                <div className=\"grid grid-cols-2 gap-4\">\r\n                  <div className=\"bg-blue-50 rounded-lg p-4\">\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <div>\r\n                        <p className=\"text-sm text-blue-800 font-medium\">\r\n                          Tickets Générés\r\n                        </p>\r\n                        <p className=\"text-xl font-bold text-blue-900 mt-1\">\r\n                          {totalTickets}\r\n                        </p>\r\n                      </div>\r\n                      <div className=\"p-2 rounded-full bg-blue-100\">\r\n                        <FiPackage className=\"h-5 w-5 text-blue-700\" />\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"bg-green-50 rounded-lg p-4\">\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <div>\r\n                        <p className=\"text-sm text-green-800 font-medium\">\r\n                          Tickets Utilisés\r\n                        </p>\r\n                        <p className=\"text-xl font-bold text-green-900 mt-1\">\r\n                          {ticketStats.used}\r\n                        </p>\r\n                      </div>\r\n                      <div className=\"p-2 rounded-full bg-green-100\">\r\n                        <FiCheckCircle className=\"h-5 w-5 text-green-700\" />\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"bg-amber-50 rounded-lg p-4\">\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <div>\r\n                        <p className=\"text-sm text-amber-800 font-medium\">\r\n                          Tickets Restants\r\n                        </p>\r\n                        <p className=\"text-xl font-bold text-amber-900 mt-1\">\r\n                          {ticketStats.remaining}\r\n                        </p>\r\n                      </div>\r\n                      <div className=\"p-2 rounded-full bg-amber-100\">\r\n                        <FiXCircle className=\"h-5 w-5 text-amber-700\" />\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"bg-purple-50 rounded-lg p-4\">\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <div>\r\n                        <p className=\"text-sm text-purple-800 font-medium\">\r\n                          Taux de Conversion\r\n                        </p>\r\n                        <p className=\"text-xl font-bold text-purple-900 mt-1\">\r\n                          {usageRate}%\r\n                        </p>\r\n                      </div>\r\n                      <div className=\"p-2 rounded-full bg-purple-100\">\r\n                        <FiTrendingUp className=\"h-5 w-5 text-purple-700\" />\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Recent Activity Section (always show) */}\r\n          <div\r\n            className={`bg-white rounded-xl shadow-md border border-gray-100 ${!hasValidTicketStats ? \"lg:col-span-2\" : \"\"}`}\r\n          >\r\n            <div className=\"px-6 py-4 border-b border-gray-200\">\r\n              <h3 className=\"text-lg font-semibold text-gray-800\">\r\n                Activité Récente\r\n              </h3>\r\n            </div>\r\n            <div className=\"p-4\">\r\n              {recentGains.length > 0 ? (\r\n                <div className=\"divide-y divide-gray-200\">\r\n                  {recentGains.map((gain, index) => (\r\n                    <div\r\n                      key={index}\r\n                      className=\"py-3 flex items-center justify-between\"\r\n                    >\r\n                      <div className=\"flex items-center\">\r\n                        <div className=\"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center text-blue-700\">\r\n                          <FiGift className=\"h-5 w-5\" />\r\n                        </div>\r\n                        <div className=\"ml-3\">\r\n                          <p className=\"text-sm font-medium text-gray-900\">\r\n                            {gain.user?.userName || \"Utilisateur\"}\r\n                          </p>\r\n                          <p className=\"text-xs text-gray-500\">\r\n                            a gagné {gain.prizeWon || \"un prix\"}\r\n                          </p>\r\n                        </div>\r\n                      </div>\r\n                      <div className=\"text-sm text-gray-500\">\r\n                        <div className=\"flex items-center\">\r\n                          <FiCalendar className=\"mr-1 h-4 w-4\" />\r\n                          {formatDate(gain.createdAt)}\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              ) : (\r\n                <div className=\"py-4 text-center text-gray-500\">\r\n                  Aucune activité récente à afficher\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  // Render Prizes Tab\r\n  const renderPrizesTab = () => {\r\n    // Get prize and ticket data from gameStats if available\r\n    const prizeDistributionData =\r\n      gameStats &&\r\n      gameStats.prizeDistribution &&\r\n      gameStats.prizeDistribution.length > 0\r\n        ? gameStats.prizeDistribution\r\n        : null;\r\n\r\n    const ticketStats =\r\n      gameStats &&\r\n      gameStats.ticketStats &&\r\n      (gameStats.ticketStats.used > 0 || gameStats.ticketStats.remaining > 0)\r\n        ? gameStats.ticketStats\r\n        : null;\r\n    const totalTickets = ticketStats\r\n      ? ticketStats.used + ticketStats.remaining\r\n      : 0;\r\n    const usageRate =\r\n      totalTickets > 0\r\n        ? Math.round((ticketStats.used / totalTickets) * 100)\r\n        : 0;\r\n\r\n    // Check for valid data for this tab\r\n    const hasValidDataForTab = prizeDistributionData || ticketStats;\r\n\r\n    // If no data is available, show a message\r\n    if (!hasValidDataForTab) {\r\n      return (\r\n        <div className=\"bg-white rounded-xl shadow-md border border-gray-100 p-6\">\r\n          <div className=\"py-12 text-center\">\r\n            <FiPackage className=\"h-12 w-12 mx-auto text-gray-400 mb-4\" />\r\n            <h3 className=\"text-lg font-medium text-gray-900 mb-2\">\r\n              Aucune donnée disponible\r\n            </h3>\r\n            <p className=\"text-gray-500\">\r\n              Les informations sur les prix et tickets ne sont pas encore\r\n              disponibles.\r\n            </p>\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return (\r\n      <div className=\"bg-white rounded-xl shadow-md border border-gray-100 p-6\">\r\n        <h3 className=\"text-lg font-semibold text-gray-800 mb-4\">\r\n          Distribution des Prix et Statistiques des Tickets\r\n        </h3>\r\n\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\r\n          {/* Prize Distribution Section - Only show if valid data */}\r\n          {prizeDistributionData && (\r\n            <div>\r\n              <h4 className=\"text-md font-medium text-gray-700 mb-4\">\r\n                Distribution des Prix\r\n              </h4>\r\n              <div className=\"h-64\">\r\n                <PrizeDistributionChart data={prizeDistributionData} />\r\n              </div>\r\n\r\n              {gameStats && gameStats.totalPrizeCount && (\r\n                <div className=\"mt-6 space-y-4\">\r\n                  <div className=\"bg-gray-50 p-4 rounded-lg\">\r\n                    <div className=\"flex justify-between items-center\">\r\n                      <div>\r\n                        <p className=\"text-sm font-medium text-gray-500\">\r\n                          Nombre total de prix\r\n                        </p>\r\n                        <p className=\"text-xl font-bold text-gray-800\">\r\n                          {gameStats.totalPrizeCount}\r\n                        </p>\r\n                      </div>\r\n                      <div className=\"p-2 rounded-full bg-blue-100 text-blue-800\">\r\n                        <FiPackage className=\"h-5 w-5\" />\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  {gameStats.totalPrizeValue && (\r\n                    <div className=\"bg-gray-50 p-4 rounded-lg\">\r\n                      <div className=\"flex justify-between items-center\">\r\n                        <div>\r\n                          <p className=\"text-sm font-medium text-gray-500\">\r\n                            Valeur totale\r\n                          </p>\r\n                          <p className=\"text-xl font-bold text-gray-800\">\r\n                            {gameStats.totalPrizeValue} €\r\n                          </p>\r\n                        </div>\r\n                        <div className=\"p-2 rounded-full bg-purple-100 text-purple-800\">\r\n                          <FiDollarSign className=\"h-5 w-5\" />\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              )}\r\n            </div>\r\n          )}\r\n\r\n          {/* Ticket Usage Section - Only show if valid data */}\r\n          {ticketStats && (\r\n            <div>\r\n              <h4 className=\"text-md font-medium text-gray-700 mb-4\">\r\n                Utilisation des Tickets\r\n              </h4>\r\n              <div className=\"h-64\">\r\n                <TicketUsageChart\r\n                  data={[\r\n                    { name: \"Utilisés\", value: ticketStats.used },\r\n                    { name: \"Non utilisés\", value: ticketStats.remaining },\r\n                  ]}\r\n                />\r\n              </div>\r\n\r\n              <div className=\"mt-6 space-y-4\">\r\n                <div className=\"bg-gray-50 p-4 rounded-lg\">\r\n                  <div className=\"flex justify-between items-center\">\r\n                    <div>\r\n                      <p className=\"text-sm font-medium text-gray-500\">\r\n                        Tickets utilisés\r\n                      </p>\r\n                      <p className=\"text-xl font-bold text-gray-800\">\r\n                        {ticketStats.used}\r\n                      </p>\r\n                    </div>\r\n                    <div className=\"p-2 rounded-full bg-green-100 text-green-800\">\r\n                      <FiCheckCircle className=\"h-5 w-5\" />\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"bg-gray-50 p-4 rounded-lg\">\r\n                  <div className=\"flex justify-between items-center\">\r\n                    <div>\r\n                      <p className=\"text-sm font-medium text-gray-500\">\r\n                        Tickets restants\r\n                      </p>\r\n                      <p className=\"text-xl font-bold text-gray-800\">\r\n                        {ticketStats.remaining}\r\n                      </p>\r\n                    </div>\r\n                    <div className=\"p-2 rounded-full bg-amber-100 text-amber-800\">\r\n                      <FiXCircle className=\"h-5 w-5\" />\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {gameStats && gameStats.gains && gameStats.gains.length > 0 && (\r\n          <div className=\"mt-8\">\r\n            <h4 className=\"text-md font-medium text-gray-700 mb-4\">\r\n              Liste des Prix Distribués ({gameStats.gains.length})\r\n            </h4>\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <DashboardLayout userType=\"admin\">\r\n      {loading ? (\r\n        <div className=\"flex justify-center items-center h-full\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600\"></div>\r\n        </div>\r\n      ) : error ? (\r\n        <div className=\"bg-red-100 border-l-4 border-red-500 text-red-700 p-4 mb-6 rounded-md\">\r\n          <p>{error}</p>\r\n        </div>\r\n      ) : (\r\n        <div className=\"space-y-6\">\r\n          <div className=\"flex justify-between items-center\">\r\n            <h1 className=\"text-2xl font-bold text-gray-900\">\r\n              Tableau de Bord Administrateur\r\n            </h1>\r\n            <div className=\"bg-blue-50 px-4 py-2 rounded-lg text-blue-800 text-sm font-medium flex items-center\">\r\n              <FiClock className=\"mr-2\" />\r\n              Dernière mise à jour: {new Date().toLocaleTimeString()}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Dashboard Tabs */}\r\n          <div className=\"border-b border-gray-200\">\r\n            <nav className=\"-mb-px flex\">\r\n              <button\r\n                onClick={() => setActiveTab(\"overview\")}\r\n                className={`px-4 py-2 font-medium text-sm ${\r\n                  activeTab === \"overview\"\r\n                    ? \"border-b-2 border-blue-500 text-blue-600\"\r\n                    : \"text-gray-500 hover:text-gray-700 hover:border-gray-300\"\r\n                }`}\r\n              >\r\n                Vue d'ensemble\r\n              </button>\r\n              <button\r\n                onClick={() => setActiveTab(\"users\")}\r\n                className={`ml-8 px-4 py-2 font-medium text-sm ${\r\n                  activeTab === \"users\"\r\n                    ? \"border-b-2 border-blue-500 text-blue-600\"\r\n                    : \"text-gray-500 hover:text-gray-700 hover:border-gray-300\"\r\n                }`}\r\n              >\r\n                Utilisateurs\r\n              </button>\r\n              <button\r\n                onClick={() => setActiveTab(\"prizes\")}\r\n                className={`ml-8 px-4 py-2 font-medium text-sm ${\r\n                  activeTab === \"prizes\"\r\n                    ? \"border-b-2 border-blue-500 text-blue-600\"\r\n                    : \"text-gray-500 hover:text-gray-700 hover:border-gray-300\"\r\n                }`}\r\n              >\r\n                Prix & Tickets\r\n              </button>\r\n            </nav>\r\n          </div>\r\n\r\n          {/* Main Content based on active tab */}\r\n          <div>\r\n            {activeTab === \"overview\" && renderOverview()}\r\n            {activeTab === \"users\" && renderUsersTab()}\r\n            {activeTab === \"prizes\" && renderPrizesTab()}\r\n          </div>\r\n\r\n          {/* User Details Modal */}\r\n          {showUserModal && <UserDetailsModal />}\r\n        </div>\r\n      )}\r\n    </DashboardLayout>\r\n  );\r\n};\r\n\r\nexport default AdminDashboard;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}