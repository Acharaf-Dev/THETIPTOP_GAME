{"ast":null,"code":"import React,{useState,useEffect}from'react';// import { Link } from 'react-router-dom';\nimport axios from'axios';import{UserIcon,MailIcon,PhoneIcon,TicketIcon,CalendarIcon,GiftIcon}from'@heroicons/react/outline';// Assuming heroicons are installed\nimport DashboardLayout from'../../components/DashboardLayout';// Adjust path if needed\n// Removed: import './client.css';\nimport'./client.css';// Simple SVG placeholder for Gift Icon if Heroicons not available\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const DefaultGiftIcon=()=>/*#__PURE__*/_jsx(\"svg\",{fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:\"2\",d:\"M12 8v13m0-13V6a2 2 0 112 2h-2zm0 0V5.5A2.5 2.5 0 109.5 8H12zm-7 4h14M5 12a2 2 0 110-4h14a2 2 0 110 4H5z\"})});// Define icons - Use Heroicons if available, otherwise use simple SVGs (Removed classes from fallbacks)\nconst ProfileIcon=UserIcon||(()=>/*#__PURE__*/_jsx(\"svg\",{fill:\"none\",viewBox:\"0 0 24 24\",stroke:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:\"2\",d:\"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z\"})}));const EmailIcon=MailIcon||(()=>/*#__PURE__*/_jsx(\"svg\",{fill:\"none\",viewBox:\"0 0 24 24\",stroke:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:\"2\",d:\"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z\"})}));const TelephoneIcon=PhoneIcon||(()=>/*#__PURE__*/_jsx(\"svg\",{fill:\"none\",viewBox:\"0 0 24 24\",stroke:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:\"2\",d:\"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z\"})}));const GainTicketIcon=TicketIcon||(()=>/*#__PURE__*/_jsx(\"svg\",{fill:\"none\",viewBox:\"0 0 24 24\",stroke:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:\"2\",d:\"M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z\"})}));const GainCalendarIcon=CalendarIcon||(()=>/*#__PURE__*/_jsx(\"svg\",{fill:\"none\",viewBox:\"0 0 24 24\",stroke:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:\"2\",d:\"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z\"})}));const GainPrizeIcon=GiftIcon||DefaultGiftIcon;const ClientDashboard=()=>{const[userData,setUserData]=useState(null);const[isLoadingProfile,setIsLoadingProfile]=useState(true);const[errorProfile,setErrorProfile]=useState(null);const[isEditing,setIsEditing]=useState(false);const[formData,setFormData]=useState({});// State for form data during edit\nconst[updateSuccess,setUpdateSuccess]=useState(null);const[updateError,setUpdateError]=useState(null);// State for gains data\nconst[gainsData,setGainsData]=useState([]);const[isLoadingGains,setIsLoadingGains]=useState(false);const[errorGains,setErrorGains]=useState(null);useEffect(()=>{const fetchUserData=async()=>{setIsLoadingProfile(true);setErrorProfile(null);const token=localStorage.getItem('token');if(!token){setErrorProfile('Authentication token not found. Please log in.');setIsLoadingProfile(false);return;}try{const response=await axios.get(`${process.env.REACT_APP_API_URL}/user/me`,{//local\n// axios.post(`${process.env.REACT_APP_API_URL}/auth/register`, payload);\n// const response = await axios.get('https://www.backend.dsp5-archi-f24a-15m-g8.fr/api/user/me', { //VPS\nheaders:{'Authorization':`Bearer ${token}`}});if(response.data.success){setUserData(response.data.user);setFormData(response.data.user);// Initialize form data\n}else{throw new Error(response.data.message||'Failed to fetch user data.');}}catch(err){var _err$response,_err$response2;console.error(\"Error fetching user data:\",err);if(((_err$response=err.response)===null||_err$response===void 0?void 0:_err$response.status)===401||((_err$response2=err.response)===null||_err$response2===void 0?void 0:_err$response2.status)===403){setErrorProfile('Session expired or invalid. Please log in again.');localStorage.removeItem('token');// Clear invalid token\n// Optionally redirect to login\n}else{setErrorProfile(err.message||'An error occurred while fetching user data.');}}finally{setIsLoadingProfile(false);}};fetchUserData();},[]);// Empty dependency array ensures this runs only once on mount\n// Function to fetch gains\nconst fetchGains=async()=>{setIsLoadingGains(true);setErrorGains(null);setGainsData([]);// Clear previous gains\nconst token=localStorage.getItem('token');if(!token){setErrorGains('Authentication token missing.');setIsLoadingGains(false);return;}try{// const response = await axios.get('https://www.backend.dsp5-archi-f24a-15m-g8.fr/api/user/my-gains', {\nconst response=await axios.get(`${process.env.REACT_APP_API_URL}/user/my-gains`,{headers:{'Authorization':`Bearer ${token}`}});if(response.data.success){setGainsData(response.data.gains);// Assuming backend returns { success: true, gains: [...] }\n}else{// Handle cases where success is false but not an error (e.g., no gains found)\nsetErrorGains(response.data.message||'Could not fetch winnings.');}}catch(err){var _err$response3,_err$response4;console.error(\"Error fetching gains:\",err);if(((_err$response3=err.response)===null||_err$response3===void 0?void 0:_err$response3.status)===401||((_err$response4=err.response)===null||_err$response4===void 0?void 0:_err$response4.status)===403){setErrorGains('Session expired or invalid. Please log in again.');localStorage.removeItem('token');}else{setErrorGains(err.message||'An error occurred while fetching winnings.');}}finally{setIsLoadingGains(false);}};// Fetch gains when component mounts after profile is loaded\nuseEffect(()=>{if(userData){// Only fetch gains if user data is available\nfetchGains();}},[userData]);// Rerun when userData changes (i.e., after initial load)\nconst handleEditToggle=()=>{setIsEditing(!isEditing);setUpdateSuccess(null);// Clear messages\nsetUpdateError(null);if(!isEditing&&userData){setFormData(userData);// Reset form data on entering edit mode\n}};const handleFormChange=e=>{setFormData({...formData,[e.target.name]:e.target.value});setUpdateSuccess(null);// Clear messages\nsetUpdateError(null);};const handleProfileUpdate=async e=>{e.preventDefault();setIsLoadingProfile(true);setUpdateSuccess(null);setUpdateError(null);const token=localStorage.getItem('token');if(!token){setUpdateError('Authentication token missing.');setIsLoadingProfile(false);return;}// Send the entire formData, but filter out specific non-editable fields\nconst payload={...formData};delete payload._id;delete payload.email;delete payload.userType;delete payload.createdAt;delete payload.updatedAt;delete payload.__v;// If password change is handled separately, ensure it's not sent here\ndelete payload.password;// Add any other fields that should NEVER be sent from the client\ntry{const response=await axios.put(`${process.env.REACT_APP_API_URL}/user/updateprofile`,payload,{headers:{'Authorization':`Bearer ${token}`}});if(response.data.success){setUserData(response.data.user);setFormData(response.data.user);setIsEditing(false);setUpdateSuccess('Profil mis à jour avec succès!');}else{throw new Error(response.data.message||'Failed to update profile.');}}catch(err){var _err$response5,_err$response5$data;console.error(\"Error updating profile:\",err);setUpdateError(((_err$response5=err.response)===null||_err$response5===void 0?void 0:(_err$response5$data=_err$response5.data)===null||_err$response5$data===void 0?void 0:_err$response5$data.message)||err.message||'An error occurred while updating profile.');}finally{setIsLoadingProfile(false);}};return/*#__PURE__*/_jsxs(DashboardLayout,{userType:\"client\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-semibold text-gray-900 mb-6\",children:\"Bienvenue sur votre Espace Profil\"}),isLoadingProfile&&!userData&&/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"Chargement de vos informations...\"}),errorProfile&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-6\",role:\"alert\",children:/*#__PURE__*/_jsx(\"span\",{className:\"block sm:inline\",children:errorProfile})}),userData&&!isLoadingProfile&&!errorProfile&&/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 gap-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-6 rounded-lg shadow-md border border-gray-200\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-semibold text-gray-800\",children:\"Mes Informations\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleEditToggle,className:`px-4 py-1 border border-transparent text-sm font-medium rounded-md shadow-sm ${isEditing?'text-gray-700 bg-gray-200 hover:bg-gray-300':'text-white bg-teal-600 hover:bg-teal-700'}`,children:isEditing?'Annuler':'Modifier'})]}),updateSuccess&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-green-100 border border-green-400 text-green-700 px-4 py-2 rounded relative mb-4 text-sm\",role:\"alert\",children:updateSuccess}),updateError&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-red-100 border border-red-400 text-red-700 px-4 py-2 rounded relative mb-4 text-sm\",role:\"alert\",children:updateError}),!isEditing?/*#__PURE__*/// --- Display Mode (Enhanced) ---\n_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center p-3 border-b border-gray-100\",children:[/*#__PURE__*/_jsx(ProfileIcon,{className:\"h-4 w-4 text-gray-500 mr-3\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600 font-medium mr-2\",children:\"Nom d'utilisateur:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-800\",children:userData.userName})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center p-3 border-b border-gray-100\",children:[/*#__PURE__*/_jsx(EmailIcon,{className:\"h-4 w-4 text-gray-500 mr-3\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600 font-medium mr-2\",children:\"Email:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-800\",children:userData.email})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center p-3\",children:[/*#__PURE__*/_jsx(TelephoneIcon,{className:\"h-4 w-4 text-gray-500 mr-3\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600 font-medium mr-2\",children:\"T\\xE9l\\xE9phone:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-800\",children:userData.phone||'Non renseigné'})]})]}):/*#__PURE__*/// --- Edit Mode Form ---\n_jsxs(\"form\",{className:\"space-y-4\",onSubmit:handleProfileUpdate,children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"userName\",className:\"block text-sm font-medium text-gray-700\",children:\"Nom d'utilisateur\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"userName\",id:\"userName\",required:true,value:formData.userName||'',onChange:handleFormChange,className:\"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"email\",className:\"block text-sm font-medium text-gray-700\",children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",name:\"email\",id:\"email\",value:formData.email||'',readOnly:true,className:\"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-gray-100 cursor-not-allowed focus:outline-none sm:text-sm\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"phone\",className:\"block text-sm font-medium text-gray-700\",children:\"T\\xE9l\\xE9phone\"}),/*#__PURE__*/_jsx(\"input\",{type:\"tel\"// Use tel type for phone numbers\n,name:\"phone\",id:\"phone\",value:formData.phone||'',onChange:handleFormChange,className:\"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm\",placeholder:\"e.g., 06 12 34 56 78\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-end gap-4 mt-6\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:handleEditToggle,className:\"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 transition duration-150 ease-in-out\",children:\"Annuler\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition duration-150 ease-in-out\",disabled:isLoadingProfile// Reuse profile loading state for update\n,children:isLoadingProfile?'Sauvegarde...':'Sauvegarder les modifications'})]})]}),updateSuccess&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-4 bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative\",role:\"alert\",children:/*#__PURE__*/_jsx(\"span\",{className:\"block sm:inline\",children:updateSuccess})}),updateError&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative\",role:\"alert\",children:/*#__PURE__*/_jsx(\"span\",{className:\"block sm:inline\",children:updateError})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-8 bg-white p-6 rounded-lg shadow-md border border-gray-200\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-semibold text-gray-800 mb-4\",children:\"Mes Gains Pass\\xE9s\"}),isLoadingGains&&/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"Chargement des gains...\"}),errorGains&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4\",role:\"alert\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"block sm:inline\",children:[\"Erreur lors du chargement des gains: \",errorGains]})}),!isLoadingGains&&!errorGains&&(gainsData.length>0?/*#__PURE__*/_jsx(\"ul\",{className:\"space-y-4\",children:gainsData.map(gain=>/*#__PURE__*/_jsxs(\"li\",{className:\"border-b border-gray-200 pb-4 last:border-b-0\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(GainTicketIcon,{className:\"h-6 w-6 text-indigo-500\"}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-gray-700\",children:\"Code Ticket:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-900\",children:gain.ticketNumber})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3 mt-2\",children:[/*#__PURE__*/_jsx(GainPrizeIcon,{className:\"h-6 w-6 text-green-500\"}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-gray-700\",children:\"Lot:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-gray-900\",children:[gain.prizeWon,\" (\",gain.prizeValue,\"\\u20AC)\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3 mt-2\",children:[/*#__PURE__*/_jsx(GainCalendarIcon,{className:\"h-6 w-6 text-blue-500\"}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-gray-700\",children:\"Date:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600 text-sm\",children:new Date(gain.createdAt).toLocaleDateString('fr-FR',{year:'numeric',month:'long',day:'numeric',hour:'2-digit',minute:'2-digit'})})]})]},gain._id))}):/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"Vous n'avez pas encore enregistr\\xE9 de gains.\"}))]})]})]});};export default ClientDashboard;","map":{"version":3,"names":["React","useState","useEffect","axios","UserIcon","MailIcon","PhoneIcon","TicketIcon","CalendarIcon","GiftIcon","DashboardLayout","jsx","_jsx","jsxs","_jsxs","DefaultGiftIcon","fill","stroke","viewBox","children","strokeLinecap","strokeLinejoin","strokeWidth","d","ProfileIcon","EmailIcon","TelephoneIcon","GainTicketIcon","GainCalendarIcon","GainPrizeIcon","ClientDashboard","userData","setUserData","isLoadingProfile","setIsLoadingProfile","errorProfile","setErrorProfile","isEditing","setIsEditing","formData","setFormData","updateSuccess","setUpdateSuccess","updateError","setUpdateError","gainsData","setGainsData","isLoadingGains","setIsLoadingGains","errorGains","setErrorGains","fetchUserData","token","localStorage","getItem","response","get","process","env","REACT_APP_API_URL","headers","data","success","user","Error","message","err","_err$response","_err$response2","console","error","status","removeItem","fetchGains","gains","_err$response3","_err$response4","handleEditToggle","handleFormChange","e","target","name","value","handleProfileUpdate","preventDefault","payload","_id","email","userType","createdAt","updatedAt","__v","password","put","_err$response5","_err$response5$data","className","role","onClick","userName","phone","onSubmit","htmlFor","type","id","required","onChange","readOnly","placeholder","disabled","length","map","gain","ticketNumber","prizeWon","prizeValue","Date","toLocaleDateString","year","month","day","hour","minute"],"sources":["D:/Projet/Nouveau dossier/THETIPTOP_GAME/frontend/src/pages/Dashbords/ClientDashboard.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\n// import { Link } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport { UserIcon, MailIcon, PhoneIcon, TicketIcon, CalendarIcon, GiftIcon } from '@heroicons/react/outline'; // Assuming heroicons are installed\r\nimport DashboardLayout from '../../components/DashboardLayout'; // Adjust path if needed\r\n// Removed: import './client.css';\r\nimport './client.css';\r\n\r\n// Simple SVG placeholder for Gift Icon if Heroicons not available\r\nconst DefaultGiftIcon = () => <svg fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M12 8v13m0-13V6a2 2 0 112 2h-2zm0 0V5.5A2.5 2.5 0 109.5 8H12zm-7 4h14M5 12a2 2 0 110-4h14a2 2 0 110 4H5z\" /></svg>;\r\n\r\n// Define icons - Use Heroicons if available, otherwise use simple SVGs (Removed classes from fallbacks)\r\nconst ProfileIcon = UserIcon || (() => <svg fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z\" /></svg>); \r\nconst EmailIcon = MailIcon || (() => <svg fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z\" /></svg>);\r\nconst TelephoneIcon = PhoneIcon || (() => <svg fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z\" /></svg>);\r\nconst GainTicketIcon = TicketIcon || (() => <svg fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z\" /></svg>);\r\nconst GainCalendarIcon = CalendarIcon || (() => <svg fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z\" /></svg>);\r\nconst GainPrizeIcon = GiftIcon || DefaultGiftIcon;\r\n\r\nconst ClientDashboard = () => {\r\n  const [userData, setUserData] = useState(null);\r\n  const [isLoadingProfile, setIsLoadingProfile] = useState(true);\r\n  const [errorProfile, setErrorProfile] = useState(null);\r\n  const [isEditing, setIsEditing] = useState(false);\r\n  const [formData, setFormData] = useState({}); // State for form data during edit\r\n  const [updateSuccess, setUpdateSuccess] = useState(null);\r\n  const [updateError, setUpdateError] = useState(null);\r\n\r\n  // State for gains data\r\n  const [gainsData, setGainsData] = useState([]);\r\n  const [isLoadingGains, setIsLoadingGains] = useState(false);\r\n  const [errorGains, setErrorGains] = useState(null);\r\n\r\n  useEffect(() => {\r\n    const fetchUserData = async () => {\r\n      setIsLoadingProfile(true);\r\n      setErrorProfile(null);\r\n      const token = localStorage.getItem('token');\r\n\r\n      if (!token) {\r\n        setErrorProfile('Authentication token not found. Please log in.');\r\n        setIsLoadingProfile(false);\r\n        return;\r\n      }\r\n\r\n      try {\r\n        const response = await axios.get(`${process.env.REACT_APP_API_URL}/user/me`, {  //local\r\n          // axios.post(`${process.env.REACT_APP_API_URL}/auth/register`, payload);\r\n\r\n        // const response = await axios.get('https://www.backend.dsp5-archi-f24a-15m-g8.fr/api/user/me', { //VPS\r\n          headers: {\r\n            'Authorization': `Bearer ${token}`\r\n          }\r\n        });\r\n\r\n        if (response.data.success) {\r\n          setUserData(response.data.user);\r\n          setFormData(response.data.user); // Initialize form data\r\n        } else {\r\n          throw new Error(response.data.message || 'Failed to fetch user data.');\r\n        }\r\n      } catch (err) {\r\n        console.error(\"Error fetching user data:\", err);\r\n        if (err.response?.status === 401 || err.response?.status === 403) {\r\n             setErrorProfile('Session expired or invalid. Please log in again.');\r\n             localStorage.removeItem('token'); // Clear invalid token\r\n             // Optionally redirect to login\r\n        } else {\r\n            setErrorProfile(err.message || 'An error occurred while fetching user data.');\r\n        }\r\n      } finally {\r\n        setIsLoadingProfile(false);\r\n      }\r\n    };\r\n\r\n    fetchUserData();\r\n  }, []); // Empty dependency array ensures this runs only once on mount\r\n\r\n  // Function to fetch gains\r\n  const fetchGains = async () => {\r\n    setIsLoadingGains(true);\r\n    setErrorGains(null);\r\n    setGainsData([]); // Clear previous gains\r\n    const token = localStorage.getItem('token');\r\n\r\n    if (!token) {\r\n        setErrorGains('Authentication token missing.');\r\n        setIsLoadingGains(false);\r\n        return;\r\n    }\r\n\r\n    try {\r\n        // const response = await axios.get('https://www.backend.dsp5-archi-f24a-15m-g8.fr/api/user/my-gains', {\r\n          const response = await axios.get(`${process.env.REACT_APP_API_URL}/user/my-gains`, {\r\n            headers: { 'Authorization': `Bearer ${token}` }\r\n        });\r\n\r\n        if (response.data.success) {\r\n            setGainsData(response.data.gains); // Assuming backend returns { success: true, gains: [...] }\r\n        } else {\r\n            // Handle cases where success is false but not an error (e.g., no gains found)\r\n             setErrorGains(response.data.message || 'Could not fetch winnings.');\r\n        }\r\n    } catch (err) {\r\n        console.error(\"Error fetching gains:\", err);\r\n         if (err.response?.status === 401 || err.response?.status === 403) {\r\n             setErrorGains('Session expired or invalid. Please log in again.');\r\n             localStorage.removeItem('token'); \r\n        } else {\r\n            setErrorGains(err.message || 'An error occurred while fetching winnings.');\r\n        }\r\n    } finally {\r\n        setIsLoadingGains(false);\r\n    }\r\n  };\r\n\r\n  // Fetch gains when component mounts after profile is loaded\r\n  useEffect(() => {\r\n    if (userData) { // Only fetch gains if user data is available\r\n        fetchGains();\r\n    }\r\n  }, [userData]); // Rerun when userData changes (i.e., after initial load)\r\n\r\n  const handleEditToggle = () => {\r\n    setIsEditing(!isEditing);\r\n    setUpdateSuccess(null); // Clear messages\r\n    setUpdateError(null);\r\n    if (!isEditing && userData) {\r\n        setFormData(userData); // Reset form data on entering edit mode\r\n    }\r\n  };\r\n\r\n  const handleFormChange = (e) => {\r\n    setFormData({ ...formData, [e.target.name]: e.target.value });\r\n    setUpdateSuccess(null); // Clear messages\r\n    setUpdateError(null);\r\n  };\r\n\r\n  const handleProfileUpdate = async (e) => {\r\n    e.preventDefault();\r\n    setIsLoadingProfile(true);\r\n    setUpdateSuccess(null);\r\n    setUpdateError(null);\r\n    const token = localStorage.getItem('token');\r\n\r\n    if (!token) {\r\n      setUpdateError('Authentication token missing.');\r\n      setIsLoadingProfile(false);\r\n      return;\r\n    }\r\n\r\n    // Send the entire formData, but filter out specific non-editable fields\r\n    const payload = { ...formData };\r\n    delete payload._id; \r\n    delete payload.email; \r\n    delete payload.userType; \r\n    delete payload.createdAt;\r\n    delete payload.updatedAt;\r\n    delete payload.__v;\r\n    // If password change is handled separately, ensure it's not sent here\r\n    delete payload.password; \r\n    // Add any other fields that should NEVER be sent from the client\r\n\r\n    try {\r\n      const response = await axios.put(`${process.env.REACT_APP_API_URL}/user/updateprofile`, payload, {\r\n        headers: { 'Authorization': `Bearer ${token}` }\r\n      });\r\n\r\n      if (response.data.success) {\r\n        setUserData(response.data.user); \r\n        setFormData(response.data.user); \r\n        setIsEditing(false);\r\n        setUpdateSuccess('Profil mis à jour avec succès!');\r\n      } else {\r\n        throw new Error(response.data.message || 'Failed to update profile.');\r\n      }\r\n    } catch (err) {\r\n      console.error(\"Error updating profile:\", err);\r\n      setUpdateError(err.response?.data?.message || err.message || 'An error occurred while updating profile.');\r\n    } finally {\r\n      setIsLoadingProfile(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <DashboardLayout userType=\"client\">\r\n      {/* Page specific content removed, integrated below */}\r\n      <h1 className=\"text-2xl font-semibold text-gray-900 mb-6\">\r\n        Bienvenue sur votre Espace Profil\r\n      </h1>\r\n\r\n      {isLoadingProfile && !userData && <p className=\"text-gray-600\">Chargement de vos informations...</p>}\r\n      \r\n      {errorProfile && (\r\n           <div className=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-6\" role=\"alert\">\r\n                <span className=\"block sm:inline\">{errorProfile}</span>\r\n            </div>\r\n      )}\r\n\r\n      {userData && !isLoadingProfile && !errorProfile && (\r\n        <div className=\"grid grid-cols-1 gap-8\">\r\n          {/* User Info Card */}\r\n          <div className=\"bg-white p-6 rounded-lg shadow-md border border-gray-200\">\r\n            <div className=\"flex justify-between items-center mb-6\">\r\n                <h3 className=\"text-xl font-semibold text-gray-800\">Mes Informations</h3>\r\n                <button \r\n                    onClick={handleEditToggle}\r\n                    className={`px-4 py-1 border border-transparent text-sm font-medium rounded-md shadow-sm ${isEditing ? 'text-gray-700 bg-gray-200 hover:bg-gray-300' : 'text-white bg-teal-600 hover:bg-teal-700'}`}\r\n                >\r\n                    {isEditing ? 'Annuler' : 'Modifier'}\r\n                </button>\r\n            </div>\r\n\r\n            {updateSuccess && (\r\n                <div className=\"bg-green-100 border border-green-400 text-green-700 px-4 py-2 rounded relative mb-4 text-sm\" role=\"alert\">\r\n                    {updateSuccess}\r\n                </div>\r\n            )}\r\n            {updateError && (\r\n                <div className=\"bg-red-100 border border-red-400 text-red-700 px-4 py-2 rounded relative mb-4 text-sm\" role=\"alert\">\r\n                    {updateError}\r\n                </div>\r\n            )}\r\n\r\n            {!isEditing ? (\r\n                // --- Display Mode (Enhanced) ---\r\n                <div className=\"space-y-4\">\r\n                    <div className=\"flex items-center p-3 border-b border-gray-100\">\r\n                        <ProfileIcon className=\"h-4 w-4 text-gray-500 mr-3\" /> \r\n                        <span className=\"text-gray-600 font-medium mr-2\">Nom d'utilisateur:</span>\r\n                        <span className=\"text-gray-800\">{userData.userName}</span>\r\n                    </div>\r\n                    <div className=\"flex items-center p-3 border-b border-gray-100\">\r\n                        <EmailIcon className=\"h-4 w-4 text-gray-500 mr-3\" /> \r\n                        <span className=\"text-gray-600 font-medium mr-2\">Email:</span>\r\n                        <span className=\"text-gray-800\">{userData.email}</span>\r\n                    </div>\r\n                    <div className=\"flex items-center p-3\">\r\n                        <TelephoneIcon className=\"h-4 w-4 text-gray-500 mr-3\" /> \r\n                        <span className=\"text-gray-600 font-medium mr-2\">Téléphone:</span>\r\n                        <span className=\"text-gray-800\">{userData.phone || 'Non renseigné'}</span>\r\n                    </div>\r\n                </div>\r\n            ) : (\r\n                // --- Edit Mode Form ---\r\n                <form className=\"space-y-4\" onSubmit={handleProfileUpdate}>\r\n                    <div>\r\n                        <label htmlFor=\"userName\" className=\"block text-sm font-medium text-gray-700\">Nom d'utilisateur</label>\r\n                        <input\r\n                            type=\"text\"\r\n                            name=\"userName\"\r\n                            id=\"userName\"\r\n                            required\r\n                            value={formData.userName || ''}\r\n                            onChange={handleFormChange}\r\n                            className=\"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm\"\r\n                        />\r\n                    </div>\r\n                    <div>\r\n                        <label htmlFor=\"email\" className=\"block text-sm font-medium text-gray-700\">Email</label>\r\n                        <input\r\n                            type=\"email\"\r\n                            name=\"email\"\r\n                            id=\"email\"\r\n                            value={formData.email || ''}\r\n                            readOnly\r\n                            className=\"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-gray-100 cursor-not-allowed focus:outline-none sm:text-sm\"\r\n                        />\r\n                    </div>\r\n                    <div>\r\n                        <label htmlFor=\"phone\" className=\"block text-sm font-medium text-gray-700\">Téléphone</label>\r\n                        <input\r\n                            type=\"tel\" // Use tel type for phone numbers\r\n                            name=\"phone\"\r\n                            id=\"phone\"\r\n                            value={formData.phone || ''}\r\n                            onChange={handleFormChange}\r\n                            className=\"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm\"\r\n                            placeholder=\"e.g., 06 12 34 56 78\"\r\n                        />\r\n                    </div>\r\n                    {/* Add other editable fields here */}\r\n                    \r\n                    {/* Consider adding password change separately */} \r\n                    \r\n                    <div className=\"flex justify-end gap-4 mt-6\">\r\n                      <button\r\n                        type=\"button\"\r\n                        onClick={handleEditToggle}\r\n                        className=\"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 transition duration-150 ease-in-out\"\r\n                      >\r\n                        Annuler\r\n                      </button>\r\n                      <button\r\n                        type=\"submit\"\r\n                        className=\"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition duration-150 ease-in-out\"\r\n                        disabled={isLoadingProfile} // Reuse profile loading state for update\r\n                      >\r\n                        {isLoadingProfile ? 'Sauvegarde...' : 'Sauvegarder les modifications'}\r\n                      </button>\r\n                    </div>\r\n                </form>\r\n            )}\r\n\r\n            {updateSuccess && (\r\n              <div className=\"mt-4 bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative\" role=\"alert\">\r\n                  <span className=\"block sm:inline\">{updateSuccess}</span>\r\n              </div>\r\n            )}\r\n            {updateError && (\r\n              <div className=\"mt-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative\" role=\"alert\">\r\n                  <span className=\"block sm:inline\">{updateError}</span>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Gains Section */}\r\n          <div className=\"mt-8 bg-white p-6 rounded-lg shadow-md border border-gray-200\">\r\n              <h3 className=\"text-xl font-semibold text-gray-800 mb-4\">Mes Gains Passés</h3>\r\n\r\n              {isLoadingGains && <p className=\"text-gray-600\">Chargement des gains...</p>}\r\n\r\n              {errorGains && (\r\n                  <div className=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4\" role=\"alert\">\r\n                      <span className=\"block sm:inline\">Erreur lors du chargement des gains: {errorGains}</span>\r\n                  </div>\r\n              )}\r\n\r\n              {!isLoadingGains && !errorGains && (\r\n                  gainsData.length > 0 ? (\r\n                      <ul className=\"space-y-4\">\r\n                          {gainsData.map((gain) => (\r\n                              <li key={gain._id} className=\"border-b border-gray-200 pb-4 last:border-b-0\">\r\n                                  <div className=\"flex items-center space-x-3\">\r\n                                      <GainTicketIcon className=\"h-6 w-6 text-indigo-500\" />\r\n                                      <span className=\"font-medium text-gray-700\">Code Ticket:</span>\r\n                                      <span className=\"text-gray-900\">{gain.ticketNumber}</span>\r\n                                  </div>\r\n                                  <div className=\"flex items-center space-x-3 mt-2\">\r\n                                      <GainPrizeIcon className=\"h-6 w-6 text-green-500\" />\r\n                                      <span className=\"font-medium text-gray-700\">Lot:</span>\r\n                                      <span className=\"text-gray-900\">{gain.prizeWon} ({gain.prizeValue}€)</span>\r\n                                  </div>\r\n                                  <div className=\"flex items-center space-x-3 mt-2\">\r\n                                      <GainCalendarIcon className=\"h-6 w-6 text-blue-500\" />\r\n                                      <span className=\"font-medium text-gray-700\">Date:</span>\r\n                                      <span className=\"text-gray-600 text-sm\">\r\n                                          {new Date(gain.createdAt).toLocaleDateString('fr-FR', {\r\n                                              year: 'numeric', month: 'long', day: 'numeric', \r\n                                              hour: '2-digit', minute: '2-digit' \r\n                                          })}\r\n                                      </span>\r\n                                  </div>\r\n                              </li>\r\n                          ))}\r\n                      </ul>\r\n                  ) : (\r\n                      <p className=\"text-gray-600\">Vous n'avez pas encore enregistré de gains.</p>\r\n                  )\r\n              )}\r\n          </div>\r\n        </div>\r\n      )}\r\n    </DashboardLayout>\r\n  );\r\n}\r\n\r\nexport default ClientDashboard;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}